"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@fuel-ts+program@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_6e753f1b81b88d2c391508fb79ab08d1";
exports.ids = ["vendor-chunks/@fuel-ts+program@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_6e753f1b81b88d2c391508fb79ab08d1"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@fuel-ts+program@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_6e753f1b81b88d2c391508fb79ab08d1/node_modules/@fuel-ts/program/dist/index.mjs":
/*!**************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@fuel-ts+program@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_6e753f1b81b88d2c391508fb79ab08d1/node_modules/@fuel-ts/program/dist/index.mjs ***!
  \**************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AbstractContract: () => (/* binding */ AbstractContract),\n/* harmony export */   AbstractProgram: () => (/* binding */ AbstractProgram),\n/* harmony export */   Contract: () => (/* binding */ Contract),\n/* harmony export */   FunctionInvocationScope: () => (/* binding */ FunctionInvocationScope),\n/* harmony export */   InstructionSet: () => (/* binding */ InstructionSet),\n/* harmony export */   MultiCallInvocationScope: () => (/* binding */ MultiCallInvocationScope),\n/* harmony export */   ScriptRequest: () => (/* binding */ ScriptRequest),\n/* harmony export */   assert: () => (/* binding */ assert),\n/* harmony export */   buildDryRunResult: () => (/* binding */ buildDryRunResult),\n/* harmony export */   buildFunctionResult: () => (/* binding */ buildFunctionResult),\n/* harmony export */   buildPreConfirmationFunctionResult: () => (/* binding */ buildPreConfirmationFunctionResult),\n/* harmony export */   extractInvocationResult: () => (/* binding */ extractInvocationResult),\n/* harmony export */   getAbisFromAllCalls: () => (/* binding */ getAbisFromAllCalls),\n/* harmony export */   getAllResultLogs: () => (/* binding */ getAllResultLogs),\n/* harmony export */   getResultLogs: () => (/* binding */ getResultLogs)\n/* harmony export */ });\n/* harmony import */ var _fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @fuel-ts/account */ \"(ssr)/./node_modules/.pnpm/@fuel-ts+account@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_f204daa1b5bd0d8f80ab398db79a8f51/node_modules/@fuel-ts/account/dist/index.mjs\");\n/* harmony import */ var _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @fuel-ts/errors */ \"(ssr)/./node_modules/.pnpm/@fuel-ts+errors@0.101.1/node_modules/@fuel-ts/errors/dist/index.mjs\");\n/* harmony import */ var _fuel_ts_address__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @fuel-ts/address */ \"(ssr)/./node_modules/.pnpm/@fuel-ts+address@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_12808c1e18925070bf8378bf9ead890c/node_modules/@fuel-ts/address/dist/index.mjs\");\n/* harmony import */ var _fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @fuel-ts/math */ \"(ssr)/./node_modules/.pnpm/@fuel-ts+math@0.101.1/node_modules/@fuel-ts/math/dist/index.mjs\");\n/* harmony import */ var _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @fuel-ts/transactions */ \"(ssr)/./node_modules/.pnpm/@fuel-ts+transactions@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@_dc6813ea14c53ffd87ce32c7cc62a339/node_modules/@fuel-ts/transactions/dist/index.mjs\");\n/* harmony import */ var _fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @fuel-ts/utils */ \"(ssr)/./node_modules/.pnpm/@fuel-ts+utils@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_j_f5ff000e110be614030afd6e0fd99f41/node_modules/@fuel-ts/utils/dist/index.mjs\");\n/* harmony import */ var _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @fuels/vm-asm */ \"(ssr)/./node_modules/.pnpm/@fuels+vm-asm@0.60.2/node_modules/@fuels/vm-asm/dist/node/index.cjs\");\n/* harmony import */ var ramda__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ramda */ \"(ssr)/./node_modules/.pnpm/ramda@0.30.1/node_modules/ramda/es/clone.js\");\n/* harmony import */ var _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @fuel-ts/abi-coder */ \"(ssr)/./node_modules/.pnpm/@fuel-ts+abi-coder@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6_6403986254e63357a3dfff475209c93d/node_modules/@fuel-ts/abi-coder/dist/index.mjs\");\n/* harmony import */ var _fuel_ts_address_configs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @fuel-ts/address/configs */ \"(ssr)/./node_modules/.pnpm/@fuel-ts+address@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_12808c1e18925070bf8378bf9ead890c/node_modules/@fuel-ts/address/dist/configs.mjs\");\nvar __defProp = Object.defineProperty;\nvar __name = (target, value) => __defProp(target, \"name\", { value, configurable: true });\n\n// src/types.ts\nvar AbstractProgram = class {\n  static {\n    __name(this, \"AbstractProgram\");\n  }\n};\nvar AbstractContract = class extends AbstractProgram {\n  static {\n    __name(this, \"AbstractContract\");\n  }\n};\n\n// src/utils.ts\n\n\nfunction assert(condition, message) {\n  if (!condition) {\n    throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(_fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.TRANSACTION_ERROR, message);\n  }\n}\n__name(assert, \"assert\");\nfunction getAbisFromAllCalls(functionScopes) {\n  return functionScopes.reduce((acc, funcScope, i) => {\n    const { program, externalAbis } = funcScope.getCallConfig();\n    if (i === 0) {\n      acc.main = program.interface.jsonAbi;\n      acc.otherContractsAbis = {};\n    } else {\n      acc.otherContractsAbis[program.id.toB256()] = program.interface.jsonAbi;\n    }\n    acc.otherContractsAbis = { ...acc.otherContractsAbis, ...externalAbis };\n    return acc;\n  }, {});\n}\n__name(getAbisFromAllCalls, \"getAbisFromAllCalls\");\nvar getResultLogs = /* @__PURE__ */ __name((receipts, mainCallConfig, functionScopes) => {\n  if (!mainCallConfig) {\n    return [];\n  }\n  const { main, otherContractsAbis } = getAbisFromAllCalls(functionScopes);\n  return (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.getDecodedLogs)(receipts, main, otherContractsAbis);\n}, \"getResultLogs\");\nvar getAllResultLogs = /* @__PURE__ */ __name((opts) => {\n  const { receipts, mainCallConfig, functionScopes } = opts;\n  if (!mainCallConfig) {\n    return { logs: [], groupedLogs: {} };\n  }\n  const { main, otherContractsAbis } = getAbisFromAllCalls(functionScopes);\n  return (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.getAllDecodedLogs)({ receipts, mainAbi: main, externalAbis: otherContractsAbis });\n}, \"getAllResultLogs\");\n\n// src/functions/invocation-scope.ts\n\n\n\n// src/functions/base-invocation-scope.ts\n\n\n\n\n\n\n\n\n\n// src/contract-call-script.ts\n\n\n\n\n\n\n\n\n// src/instruction-set.ts\n\nvar InstructionSet = class {\n  static {\n    __name(this, \"InstructionSet\");\n  }\n  #operations;\n  constructor(...args) {\n    this.#operations = args || [];\n  }\n  entries() {\n    return this.#operations;\n  }\n  push(...args) {\n    this.#operations.push(...args);\n  }\n  concat(ops) {\n    return this.#operations.concat(ops);\n  }\n  extend(ops) {\n    this.#operations.push(...ops);\n  }\n  toBytes() {\n    return (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.concat)(\n      this.#operations.reduce((instructions, line) => {\n        instructions.push(line.to_bytes());\n        return instructions;\n      }, [])\n    );\n  }\n  toHex() {\n    return (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.hexlify)(this.toBytes());\n  }\n  toString() {\n    return `Program:\n${JSON.stringify(this.#operations, null, 2)}`;\n  }\n  byteLength() {\n    return this.toBytes().byteLength;\n  }\n};\n\n// src/script-request.ts\n\n\n\n\n\nvar calculateScriptDataBaseOffset = /* @__PURE__ */ __name((maxInputs) => _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.SCRIPT_FIXED_SIZE + (0,_fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.calculateVmTxMemory)({ maxInputs }), \"calculateScriptDataBaseOffset\");\nvar POINTER_DATA_OFFSET = _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.WORD_SIZE + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.ASSET_ID_LEN + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.CONTRACT_ID_LEN + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.WORD_SIZE + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.WORD_SIZE;\nfunction callResultToScriptResult(callResult) {\n  const receipts = [...callResult.receipts];\n  let scriptResultReceipt;\n  let returnReceipt;\n  receipts.forEach((receipt) => {\n    if (receipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.ScriptResult) {\n      scriptResultReceipt = receipt;\n    } else if (receipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.Return || receipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.ReturnData || receipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.Revert) {\n      returnReceipt = receipt;\n    }\n  });\n  if (!scriptResultReceipt || !returnReceipt) {\n    throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(_fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.SCRIPT_REVERTED, `Transaction reverted.`);\n  }\n  const scriptResult = {\n    code: scriptResultReceipt.result,\n    gasUsed: scriptResultReceipt.gasUsed,\n    receipts,\n    scriptResultReceipt,\n    returnReceipt,\n    callResult\n  };\n  return scriptResult;\n}\n__name(callResultToScriptResult, \"callResultToScriptResult\");\nfunction decodeCallResult(callResult, decoder, logs = [], groupedLogs = {}) {\n  try {\n    const scriptResult = callResultToScriptResult(callResult);\n    return decoder(scriptResult);\n  } catch (error) {\n    if (error.code === _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.SCRIPT_REVERTED) {\n      const statusReason = callResult?.dryRunStatus?.reason;\n      throw (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.extractTxError)({\n        logs,\n        groupedLogs,\n        receipts: callResult.receipts,\n        statusReason\n      });\n    }\n    throw error;\n  }\n}\n__name(decodeCallResult, \"decodeCallResult\");\nfunction callResultToInvocationResult(callResult, call2, logs, groupedLogs) {\n  return decodeCallResult(\n    callResult,\n    (scriptResult) => {\n      if (scriptResult.returnReceipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.Revert) {\n        throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(\n          _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.SCRIPT_REVERTED,\n          `Script Reverted. Logs: ${JSON.stringify(logs)}`\n        );\n      }\n      if (scriptResult.returnReceipt.type !== _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.Return && scriptResult.returnReceipt.type !== _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.ReturnData) {\n        const { type } = scriptResult.returnReceipt;\n        throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(\n          _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.SCRIPT_REVERTED,\n          `Script Return Type [${type}] Invalid. Logs: ${JSON.stringify({\n            logs,\n            groupedLogs,\n            receipt: scriptResult.returnReceipt\n          })}`\n        );\n      }\n      let value;\n      if (scriptResult.returnReceipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.Return) {\n        value = scriptResult.returnReceipt.val;\n      }\n      if (scriptResult.returnReceipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.ReturnData) {\n        const decoded = call2.func.decodeOutput(scriptResult.returnReceipt.data);\n        value = decoded[0];\n      }\n      return value;\n    },\n    logs\n  );\n}\n__name(callResultToInvocationResult, \"callResultToInvocationResult\");\nvar ScriptRequest = class _ScriptRequest {\n  static {\n    __name(this, \"ScriptRequest\");\n  }\n  /**\n   * The bytes of the script.\n   */\n  bytes;\n  /**\n   * A function to encode the script data.\n   */\n  scriptDataEncoder;\n  /**\n   * A function to decode the script result.\n   */\n  scriptResultDecoder;\n  /**\n   * Creates an instance of the ScriptRequest class.\n   *\n   * @param bytes - The bytes of the script.\n   * @param scriptDataEncoder - The script data encoder function.\n   * @param scriptResultDecoder - The script result decoder function.\n   */\n  constructor(bytes, scriptDataEncoder, scriptResultDecoder2) {\n    this.bytes = (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.arrayify)(bytes);\n    this.scriptDataEncoder = scriptDataEncoder;\n    this.scriptResultDecoder = scriptResultDecoder2;\n  }\n  /**\n   * Gets the script data offset for the given bytes.\n   *\n   * @param byteLength - The byte length of the script.\n   * @param maxInputs - The maxInputs value from the chain's consensus params.\n   * @returns The script data offset.\n   */\n  static getScriptDataOffsetWithScriptBytes(byteLength, maxInputs) {\n    const scriptDataBaseOffset = (0,_fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.calculateVmTxMemory)({ maxInputs }) + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.SCRIPT_FIXED_SIZE;\n    return scriptDataBaseOffset + byteLength;\n  }\n  /**\n   * Gets the script data offset.\n   *\n   * @param maxInputs - The maxInputs value from the chain's consensus params.\n   * @returns The script data offset.\n   */\n  getScriptDataOffset(maxInputs) {\n    return _ScriptRequest.getScriptDataOffsetWithScriptBytes(this.bytes.length, maxInputs);\n  }\n  /**\n   * Encodes the data for a script call.\n   *\n   * @param data - The script data.\n   * @returns The encoded data.\n   */\n  encodeScriptData(data) {\n    const callScript = this.scriptDataEncoder(data);\n    if (ArrayBuffer.isView(callScript)) {\n      return callScript;\n    }\n    this.bytes = (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.arrayify)(callScript.script);\n    return callScript.data;\n  }\n  /**\n   * Decodes the result of a script call.\n   *\n   * @param callResult - The CallResult from the script call.\n   * @param logs - Optional logs associated with the decoding.\n   * @returns The decoded result.\n   */\n  decodeCallResult(callResult, logs = []) {\n    return decodeCallResult(callResult, this.scriptResultDecoder, logs);\n  }\n};\n\n// src/contract-call-script.ts\nvar DEFAULT_OPCODE_PARAMS = {\n  assetIdOffset: 0,\n  amountOffset: 0,\n  gasForwardedOffset: 0,\n  callDataOffset: 0\n};\nvar SCRIPT_WRAPPER_CONTRACT_ID = _fuel_ts_address_configs__WEBPACK_IMPORTED_MODULE_8__.ZeroBytes32;\nvar getSingleCallInstructions = /* @__PURE__ */ __name(({\n  callDataOffset,\n  gasForwardedOffset,\n  amountOffset,\n  assetIdOffset\n}) => {\n  const inst = new InstructionSet(\n    _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.movi(16, callDataOffset),\n    _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.movi(17, amountOffset),\n    _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.lw(17, 17, 0),\n    _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.movi(18, assetIdOffset)\n  );\n  if (gasForwardedOffset) {\n    inst.push(\n      _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.movi(19, gasForwardedOffset),\n      _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.lw(19, 19, 0),\n      _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.call(16, 17, 18, 19)\n    );\n  } else {\n    inst.push(_fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.call(16, 17, 18, _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.RegId.cgas().to_u8()));\n  }\n  return inst;\n}, \"getSingleCallInstructions\");\nfunction getInstructions(offsets) {\n  if (!offsets.length) {\n    return new Uint8Array();\n  }\n  const multiCallInstructions = new InstructionSet();\n  for (let i = 0; i < offsets.length; i += 1) {\n    multiCallInstructions.extend(getSingleCallInstructions(offsets[i]).entries());\n  }\n  multiCallInstructions.push(_fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.ret(1));\n  return multiCallInstructions.toBytes();\n}\n__name(getInstructions, \"getInstructions\");\nvar isReturnType = /* @__PURE__ */ __name((type) => type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.Return || type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.ReturnData, \"isReturnType\");\nvar getMainCallReceipt = /* @__PURE__ */ __name((receipts, contractId) => receipts.find(\n  ({ type, id, to }) => type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.Call && id === SCRIPT_WRAPPER_CONTRACT_ID && to === contractId\n), \"getMainCallReceipt\");\nvar scriptResultDecoder = /* @__PURE__ */ __name((contractId) => (result) => {\n  if ((0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.toNumber)(result.code) !== 0) {\n    throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(_fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.SCRIPT_REVERTED, `Transaction reverted.`);\n  }\n  const mainCallResult = getMainCallReceipt(\n    result.receipts,\n    contractId.toB256()\n  );\n  const mainCallInstructionStart = (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(mainCallResult?.is);\n  const receipts = result.receipts;\n  return receipts.filter(({ type }) => isReturnType(type)).flatMap((receipt) => {\n    if (!mainCallInstructionStart.eq((0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(receipt.is))) {\n      return [];\n    }\n    if (receipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.Return) {\n      return [new _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.BigNumberCoder(\"u64\").encode(receipt.val)];\n    }\n    if (receipt.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.ReceiptType.ReturnData) {\n      const encodedScriptReturn = (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.arrayify)(receipt.data);\n      return [encodedScriptReturn];\n    }\n    return [new Uint8Array()];\n  });\n}, \"scriptResultDecoder\");\nvar decodeContractCallScriptResult = /* @__PURE__ */ __name((callResult, contractId, logs = [], groupedLogs = {}) => decodeCallResult(callResult, scriptResultDecoder(contractId), logs, groupedLogs), \"decodeContractCallScriptResult\");\nvar getCallInstructionsLength = /* @__PURE__ */ __name((contractCalls) => contractCalls.reduce(\n  (sum, call2) => {\n    const offset = { ...DEFAULT_OPCODE_PARAMS };\n    if (call2.gas) {\n      offset.gasForwardedOffset = 1;\n    }\n    return sum + getSingleCallInstructions(offset).byteLength();\n  },\n  _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.Instruction.size()\n  // placeholder for single RET instruction which is added later\n), \"getCallInstructionsLength\");\nvar getContractCallScript = /* @__PURE__ */ __name((functionScopes, maxInputs) => new ScriptRequest(\n  // Script to call the contract, start with stub size matching length of calls\n  getInstructions(new Array(functionScopes.length).fill(DEFAULT_OPCODE_PARAMS)),\n  (contractCalls) => {\n    const TOTAL_CALLS = contractCalls.length;\n    if (TOTAL_CALLS === 0) {\n      return { data: new Uint8Array(), script: new Uint8Array() };\n    }\n    const callInstructionsLength = getCallInstructionsLength(contractCalls);\n    const paddingLength = (8 - callInstructionsLength % 8) % 8;\n    const paddedInstructionsLength = callInstructionsLength + paddingLength;\n    const dataOffset = calculateScriptDataBaseOffset(maxInputs.toNumber()) + paddedInstructionsLength;\n    const paramOffsets = [];\n    let segmentOffset = dataOffset;\n    const scriptData = [];\n    for (let i = 0; i < TOTAL_CALLS; i += 1) {\n      const call2 = contractCalls[i];\n      const amountOffset = segmentOffset;\n      const assetIdOffset = amountOffset + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.WORD_SIZE;\n      const callDataOffset = assetIdOffset + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.ASSET_ID_LEN;\n      const encodedSelectorOffset = callDataOffset + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.CONTRACT_ID_LEN + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.WORD_SIZE + _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.WORD_SIZE;\n      const encodedArgsOffset = encodedSelectorOffset + call2.fnSelectorBytes.byteLength;\n      const encodedArgs = (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.arrayify)(call2.data);\n      let gasForwardedOffset = 0;\n      scriptData.push(new _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.BigNumberCoder(\"u64\").encode(call2.amount || 0));\n      scriptData.push(new _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.B256Coder().encode(call2.assetId?.toString() || _fuel_ts_address_configs__WEBPACK_IMPORTED_MODULE_8__.ZeroBytes32));\n      scriptData.push(call2.contractId.toBytes());\n      scriptData.push(new _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.BigNumberCoder(\"u64\").encode(encodedSelectorOffset));\n      scriptData.push(new _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.BigNumberCoder(\"u64\").encode(encodedArgsOffset));\n      scriptData.push(call2.fnSelectorBytes);\n      scriptData.push(encodedArgs);\n      if (call2.gas) {\n        scriptData.push(new _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.BigNumberCoder(\"u64\").encode(call2.gas));\n        gasForwardedOffset = encodedArgsOffset + encodedArgs.byteLength;\n      }\n      const callParamOffsets = {\n        amountOffset,\n        assetIdOffset,\n        gasForwardedOffset,\n        callDataOffset\n      };\n      paramOffsets.push(callParamOffsets);\n      segmentOffset = dataOffset + (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.concat)(scriptData).byteLength;\n    }\n    const script = getInstructions(paramOffsets);\n    const finalScriptData = (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.concat)(scriptData);\n    return { data: finalScriptData, script };\n  },\n  () => [new Uint8Array()]\n), \"getContractCallScript\");\n\n// src/response.ts\n\nvar extractInvocationResult = /* @__PURE__ */ __name((functionScopes, receipts, isMultiCall, logs, groupedLogs = {}) => {\n  const mainCallConfig = functionScopes[0]?.getCallConfig();\n  if (functionScopes.length === 1 && mainCallConfig && \"bytes\" in mainCallConfig.program) {\n    return callResultToInvocationResult({ receipts }, mainCallConfig, logs, groupedLogs);\n  }\n  const encodedResults = decodeContractCallScriptResult(\n    { receipts },\n    (mainCallConfig?.program).id,\n    logs,\n    groupedLogs\n  );\n  const decodedResults = encodedResults.map((encodedResult, i) => {\n    const { func } = functionScopes[i].getCallConfig();\n    return func.decodeOutput(encodedResult)?.[0];\n  });\n  return isMultiCall ? decodedResults : decodedResults?.[0];\n}, \"extractInvocationResult\");\nvar buildFunctionResult = /* @__PURE__ */ __name(async (params) => {\n  const { funcScope, isMultiCall, program, transactionResponse } = params;\n  const txResult = await transactionResponse.waitForResult();\n  const { receipts } = txResult;\n  const functionScopes = Array.isArray(funcScope) ? funcScope : [funcScope];\n  const mainCallConfig = functionScopes[0]?.getCallConfig();\n  const { logs, groupedLogs } = getAllResultLogs({ receipts, mainCallConfig, functionScopes });\n  const value = extractInvocationResult(\n    functionScopes,\n    receipts,\n    isMultiCall,\n    logs,\n    groupedLogs\n  );\n  const gasUsed = (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.getGasUsedFromReceipts)(receipts);\n  const submitResult = {\n    isMultiCall,\n    functionScopes,\n    value,\n    program,\n    transactionResult: txResult,\n    transactionResponse,\n    transactionId: transactionResponse.id,\n    logs,\n    groupedLogs,\n    gasUsed\n  };\n  return submitResult;\n}, \"buildFunctionResult\");\nvar buildPreConfirmationFunctionResult = /* @__PURE__ */ __name(async (params) => {\n  const { funcScope, isMultiCall, program, transactionResponse } = params;\n  const transactionResult = await transactionResponse.waitForPreConfirmation();\n  const { receipts } = transactionResult;\n  const functionScopes = Array.isArray(funcScope) ? funcScope : [funcScope];\n  const mainCallConfig = functionScopes[0]?.getCallConfig();\n  let logs;\n  let groupedLogs;\n  let gasUsed;\n  let value;\n  if (receipts) {\n    ({ logs, groupedLogs } = getAllResultLogs({ receipts, mainCallConfig, functionScopes }));\n    value = extractInvocationResult(functionScopes, receipts, isMultiCall, logs, groupedLogs);\n    gasUsed = (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.getGasUsedFromReceipts)(receipts);\n  }\n  const submitResult = {\n    isMultiCall,\n    functionScopes,\n    program,\n    transactionResult,\n    transactionResponse,\n    transactionId: transactionResponse.id,\n    logs,\n    groupedLogs,\n    gasUsed,\n    value\n  };\n  return submitResult;\n}, \"buildPreConfirmationFunctionResult\");\nvar buildDryRunResult = /* @__PURE__ */ __name((params) => {\n  const { funcScopes, callResult, isMultiCall } = params;\n  const { receipts } = callResult;\n  const functionScopes = Array.isArray(funcScopes) ? funcScopes : [funcScopes];\n  const mainCallConfig = functionScopes[0]?.getCallConfig();\n  const { logs, groupedLogs } = getAllResultLogs({ receipts, mainCallConfig, functionScopes });\n  const value = extractInvocationResult(\n    functionScopes,\n    receipts,\n    isMultiCall,\n    logs,\n    groupedLogs\n  );\n  const gasUsed = (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.getGasUsedFromReceipts)(receipts);\n  const submitResult = {\n    functionScopes,\n    callResult,\n    isMultiCall,\n    gasUsed,\n    value\n  };\n  return submitResult;\n}, \"buildDryRunResult\");\n\n// src/functions/base-invocation-scope.ts\nfunction createContractCall(funcScope) {\n  const { program, args, forward, func, callParameters, externalAbis } = funcScope.getCallConfig();\n  const data = func.encodeArguments(args);\n  return {\n    contractId: program.id,\n    fnSelectorBytes: func.selectorBytes,\n    data,\n    assetId: forward?.assetId,\n    amount: forward?.amount,\n    gas: callParameters?.gasLimit,\n    externalContractsAbis: externalAbis\n  };\n}\n__name(createContractCall, \"createContractCall\");\nvar BaseInvocationScope = class {\n  static {\n    __name(this, \"BaseInvocationScope\");\n  }\n  transactionRequest;\n  program;\n  functionInvocationScopes = [];\n  txParameters;\n  assembleTxParameters;\n  requiredCoins = [];\n  isMultiCall = false;\n  hasCallParamsGasLimit = false;\n  // flag to check if any of the callParams has gasLimit set\n  externalAbis = {};\n  /**\n   * @deprecated - Should be removed with `addSigners`\n   */\n  addSignersCallback;\n  /**\n   * Constructs an instance of BaseInvocationScope.\n   *\n   * @param program - The abstract program to be invoked.\n   * @param isMultiCall - A flag indicating whether the invocation is a multi-call.\n   */\n  constructor(program, isMultiCall) {\n    this.program = program;\n    this.isMultiCall = isMultiCall;\n    this.transactionRequest = new _fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.ScriptTransactionRequest();\n  }\n  /**\n   * Getter for the contract calls.\n   *\n   * @returns An array of contract calls.\n   */\n  get calls() {\n    return this.functionInvocationScopes.map((funcScope) => createContractCall(funcScope));\n  }\n  /**\n   * Updates the script request with the current contract calls.\n   */\n  async updateScriptRequest() {\n    const provider = this.getProvider();\n    const {\n      consensusParameters: {\n        txParameters: { maxInputs }\n      }\n    } = await provider.getChain();\n    const contractCallScript = getContractCallScript(this.functionInvocationScopes, maxInputs);\n    this.transactionRequest.setScript(contractCallScript, this.calls);\n  }\n  /**\n   * Updates the transaction request with the current input/output.\n   */\n  updateContractInputAndOutput() {\n    const calls = this.calls;\n    calls.forEach((c) => {\n      if (c.contractId) {\n        this.transactionRequest.addContractInputAndOutput(c.contractId);\n      }\n      if (c.externalContractsAbis) {\n        Object.keys(c.externalContractsAbis).forEach(\n          (contractId) => this.transactionRequest.addContractInputAndOutput(new _fuel_ts_address__WEBPACK_IMPORTED_MODULE_2__.Address(contractId))\n        );\n      }\n    });\n  }\n  /**\n   * Gets the required coins for the transaction.\n   *\n   * @returns An array of required coin quantities.\n   */\n  getRequiredCoins() {\n    const forwardingAssets = this.calls.map((call2) => ({\n      assetId: String(call2.assetId),\n      amount: (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(call2.amount || 0)\n    })).filter(({ assetId, amount }) => assetId && !(0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(amount).isZero());\n    return forwardingAssets;\n  }\n  /**\n   * Updates the required coins for the transaction.\n   */\n  updateRequiredCoins() {\n    const assets = this.getRequiredCoins();\n    const reduceForwardCoins = /* @__PURE__ */ __name((requiredCoins, { assetId, amount }) => {\n      const currentAmount = requiredCoins.get(assetId)?.amount || (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(0);\n      return requiredCoins.set(assetId, {\n        assetId: String(assetId),\n        amount: currentAmount.add(amount)\n      });\n    }, \"reduceForwardCoins\");\n    this.requiredCoins = Array.from(\n      assets.reduce(reduceForwardCoins, /* @__PURE__ */ new Map()).values()\n    );\n  }\n  /**\n   * Adds a single call to the invocation scope.\n   *\n   * @param funcScope - The function scope to add.\n   * @returns The current instance of the class.\n   */\n  addCall(funcScope) {\n    this.addCalls([funcScope]);\n    return this;\n  }\n  /**\n   * Adds multiple calls to the invocation scope.\n   *\n   * @param funcScopes - An array of function scopes to add.\n   * @returns The current instance of the class.\n   */\n  addCalls(funcScopes) {\n    this.functionInvocationScopes.push(...funcScopes);\n    this.updateContractInputAndOutput();\n    this.updateRequiredCoins();\n    return this;\n  }\n  /**\n   * Prepares the transaction by updating the script request, required coins, and checking the gas limit.\n   */\n  async prepareTransaction() {\n    await _fuels_vm_asm__WEBPACK_IMPORTED_MODULE_6__.initWasm();\n    await this.updateScriptRequest();\n    this.updateRequiredCoins();\n    this.checkGasLimitTotal();\n    if (this.transactionRequest.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.TransactionType.Script) {\n      this.transactionRequest.abis = getAbisFromAllCalls(this.functionInvocationScopes);\n    }\n  }\n  /**\n   * Checks if the total gas limit is within the acceptable range.\n   */\n  checkGasLimitTotal() {\n    const gasLimitOnCalls = this.calls.reduce((total, call2) => total.add(call2.gas || 0), (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(0));\n    if (this.transactionRequest.gasLimit.eq(0)) {\n      this.transactionRequest.gasLimit = gasLimitOnCalls;\n    } else if (gasLimitOnCalls.gt(this.transactionRequest.gasLimit)) {\n      throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(\n        _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.TRANSACTION_ERROR,\n        \"Transaction's gasLimit must be equal to or greater than the combined forwarded gas of all calls.\"\n      );\n    }\n  }\n  /**\n   * Gets the transaction cost for dry running the transaction.\n   *\n   * @returns The transaction cost details.\n   *\n   * @deprecated Use contract.fundWithRequiredCoins instead\n   * Check the migration guide https://docs.fuel.network/docs/fuels-ts/transactions/assemble-tx-migration-guide/ for more information.\n   */\n  async getTransactionCost() {\n    const request = (0,ramda__WEBPACK_IMPORTED_MODULE_9__[\"default\"])(await this.getTransactionRequest());\n    const account = this.program.account ?? _fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.Wallet.generate({ provider: this.getProvider() });\n    return account.getTransactionCost(request, {\n      quantities: this.getRequiredCoins(),\n      signatureCallback: this.addSignersCallback\n    });\n  }\n  /**\n   * Funds the transaction request with the required coins and returns it.\n   *\n   * @returns The transaction request.\n   */\n  async fundWithRequiredCoins() {\n    let request = await this.getTransactionRequest();\n    request = (0,ramda__WEBPACK_IMPORTED_MODULE_9__[\"default\"])(request);\n    let { feePayerAccount, accountCoinQuantities, ...restAssembleTxParams } = this.assembleTxParameters ?? {};\n    request.maxFee = (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(0);\n    request.gasLimit = (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(0);\n    const provider = this.getProvider();\n    const account = this.program.account ?? _fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.Wallet.generate({ provider });\n    const baseAssetId = await provider.getBaseAssetId();\n    if (!feePayerAccount) {\n      feePayerAccount = account;\n    }\n    if (!accountCoinQuantities) {\n      const outputQuantities = request.outputs.filter((o) => o.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.OutputType.Coin).map(({ amount, assetId }) => ({ assetId: String(assetId), amount: (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(amount) }));\n      accountCoinQuantities = (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.mergeQuantities)(outputQuantities, this.requiredCoins);\n      if (!accountCoinQuantities.length) {\n        accountCoinQuantities.push({ assetId: baseAssetId, amount: (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(0) });\n      }\n    }\n    let { assembledRequest, gasPrice } = await provider.assembleTx({\n      request,\n      feePayerAccount,\n      accountCoinQuantities,\n      ...restAssembleTxParams\n    });\n    assembledRequest = assembledRequest;\n    await (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.setAndValidateGasAndFeeForAssembledTx)({\n      gasPrice,\n      provider,\n      transactionRequest: assembledRequest,\n      setGasLimit: this.txParameters?.gasLimit,\n      setMaxFee: this.txParameters?.maxFee\n    });\n    return assembledRequest;\n  }\n  /**\n   * @deprecated - Should be removed with `addSigners`\n   */\n  async legacyFundWithRequiredCoins() {\n    let transactionRequest = await this.getTransactionRequest();\n    transactionRequest = (0,ramda__WEBPACK_IMPORTED_MODULE_9__[\"default\"])(transactionRequest);\n    const txCost = await this.getTransactionCost();\n    const { gasUsed, missingContractIds, outputVariables, maxFee } = txCost;\n    this.setDefaultTxParams(transactionRequest, gasUsed, maxFee);\n    missingContractIds.forEach((contractId) => {\n      transactionRequest.addContractInputAndOutput(new _fuel_ts_address__WEBPACK_IMPORTED_MODULE_2__.Address(contractId));\n    });\n    transactionRequest.addVariableOutputs(outputVariables);\n    await this.program.account?.fund(transactionRequest, txCost);\n    if (this.addSignersCallback) {\n      await this.addSignersCallback(transactionRequest);\n    }\n    return transactionRequest;\n  }\n  /**\n   * Sets the transaction parameters.\n   *\n   * @param txParams - The transaction parameters to set.\n   * @returns The current instance of the class.\n   */\n  txParams(txParams) {\n    this.txParameters = txParams;\n    const request = this.transactionRequest;\n    request.tip = (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(txParams.tip || request.tip);\n    request.gasLimit = (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(txParams.gasLimit || request.gasLimit);\n    request.maxFee = txParams.maxFee ? (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(txParams.maxFee) : request.maxFee;\n    request.witnessLimit = txParams.witnessLimit ? (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(txParams.witnessLimit) : request.witnessLimit;\n    request.maturity = txParams.maturity || request.maturity;\n    request.expiration = txParams.expiration || request.expiration;\n    request.addVariableOutputs(this.txParameters?.variableOutputs || 0);\n    return this;\n  }\n  /**\n   * Sets the transaction parameters.\n   *\n   * @param assembleTxParams - The assembleTx parameters to set when invoking the `provider.assembleTx` method.\n   * @returns The current instance of the class.\n   */\n  assembleTxParams(txParams) {\n    this.assembleTxParameters = txParams;\n    return this;\n  }\n  /**\n   * Adds contracts to the invocation scope.\n   *\n   * @param contracts - An array of contracts to add.\n   * @returns The current instance of the class.\n   */\n  addContracts(contracts) {\n    contracts.forEach((contract) => {\n      if (typeof contract === \"string\") {\n        this.transactionRequest.addContractInputAndOutput(new _fuel_ts_address__WEBPACK_IMPORTED_MODULE_2__.Address(contract));\n      } else {\n        this.transactionRequest.addContractInputAndOutput(contract.id);\n        this.externalAbis[contract.id.toB256()] = contract.interface.jsonAbi;\n      }\n    });\n    return this;\n  }\n  /**\n   * Adds an asset transfer to an Account on the contract call transaction request.\n   *\n   * @param transferParams - The object representing the transfer to be made.\n   * @returns The current instance of the class.\n   */\n  addTransfer(transferParams) {\n    const { amount, destination, assetId } = transferParams;\n    this.transactionRequest = this.transactionRequest.addCoinOutput(\n      new _fuel_ts_address__WEBPACK_IMPORTED_MODULE_2__.Address(destination),\n      amount,\n      assetId\n    );\n    return this;\n  }\n  /**\n   * Adds multiple transfers to the contract call transaction request.\n   *\n   * @param transferParams - An array of `TransferParams` objects representing the transfers to be made.\n   * @returns The current instance of the class.\n   */\n  addBatchTransfer(transferParams) {\n    transferParams.forEach(({ destination, amount, assetId }) => {\n      this.transactionRequest = this.transactionRequest.addCoinOutput(\n        new _fuel_ts_address__WEBPACK_IMPORTED_MODULE_2__.Address(destination),\n        amount,\n        assetId\n      );\n    });\n    return this;\n  }\n  /**\n   * Adds signers to the transaction request.\n   *\n   * @param signers - The signers to add.\n   * @returns The current instance of the class.\n   *\n   * @deprecated This method is deprecated and will be removed in a future versions.\n   * All signatures should be manually added to the transaction request witnesses. If your\n   * Sway program relies on in-code signature validation, visit this guide:\n   * https://docs.fuel.network/docs/fuels-ts/cookbook/sway-script-with-signature-validation/\n   */\n  addSigners(signers) {\n    this.addSignersCallback = (transactionRequest) => transactionRequest.addAccountWitnesses(signers);\n    return this;\n  }\n  /**\n   * Prepares and returns the transaction request object.\n   *\n   * @returns The prepared transaction request.\n   */\n  async getTransactionRequest() {\n    await this.prepareTransaction();\n    return this.transactionRequest;\n  }\n  /**\n   * Sets the transaction request. Useful when you have used `getTransactionRequest` or\n   * `fundWithRequiredCoins` from the scope to apply customizations to the transaction request.\n   *\n   * @param request - The transaction request to set.\n   * @returns The current instance of the class.\n   */\n  fromRequest(request) {\n    this.transactionRequest = request;\n    return this;\n  }\n  /**\n   * Submits the contract call transaction and returns a promise that resolves to an object\n   * containing the transaction ID and a function to wait for the result. The promise will resolve\n   * as soon as the transaction is submitted to the node.\n   *\n   * @param params - Optional parameters for the call.\n   * - `skipAssembleTx`: A boolean indicating whether to skip assembling the transaction. This is useful\n   *   when customizations were made to the transaction request using the `assembleTx` method.\n   *\n   * @returns A promise that resolves to an object containing:\n   * - `transactionId`: The ID of the submitted transaction.\n   * - `waitForResult`: A function that waits for the transaction result.\n   * - `waitForPreConfirmation`: A function that waits for the transaction pre-confirmation.\n   * @template T - The type of the return value.\n   */\n  async call(params) {\n    assert(this.program.account, \"Wallet is required!\");\n    let transactionRequest = await this.getTransactionRequest();\n    const skipAssembleTx = params?.skipAssembleTx;\n    if (!skipAssembleTx) {\n      if (this.addSignersCallback) {\n        transactionRequest = await this.legacyFundWithRequiredCoins();\n      } else {\n        transactionRequest = await this.fundWithRequiredCoins();\n      }\n    }\n    const response = await this.program.account.sendTransaction(transactionRequest, {\n      estimateTxDependencies: false\n    });\n    const transactionId = response.id;\n    return {\n      transactionId,\n      waitForResult: /* @__PURE__ */ __name(async () => buildFunctionResult({\n        funcScope: this.functionInvocationScopes,\n        isMultiCall: this.isMultiCall,\n        program: this.program,\n        transactionResponse: response\n      }), \"waitForResult\"),\n      waitForPreConfirmation: /* @__PURE__ */ __name(async () => buildPreConfirmationFunctionResult({\n        funcScope: this.functionInvocationScopes,\n        isMultiCall: this.isMultiCall,\n        program: this.program,\n        transactionResponse: response\n      }), \"waitForPreConfirmation\")\n    };\n  }\n  /**\n   * Simulates a transaction.\n   *\n   * @returns The result of the invocation call.\n   */\n  async simulate() {\n    assert(this.program.account, \"Wallet is required!\");\n    if (!(\"populateTransactionWitnessesSignature\" in this.program.account)) {\n      throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(\n        _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.ABI_MAIN_METHOD_MISSING,\n        \"An unlocked wallet is required to simulate a contract call.\"\n      );\n    }\n    const transactionRequest = await this.fundWithRequiredCoins();\n    const callResult = await this.program.account.simulateTransaction(transactionRequest, {\n      estimateTxDependencies: false\n    });\n    return buildDryRunResult({\n      funcScopes: this.functionInvocationScopes,\n      callResult,\n      isMultiCall: this.isMultiCall\n    });\n  }\n  /**\n   * Executes a transaction in dry run mode.\n   *\n   * @returns The result of the invocation call.\n   *\n   * @deprecated Use .get instead\n   */\n  async dryRun() {\n    const { receipts } = await this.getTransactionCost();\n    const callResult = {\n      receipts\n    };\n    return buildDryRunResult({\n      funcScopes: this.functionInvocationScopes,\n      callResult,\n      isMultiCall: this.isMultiCall\n    });\n  }\n  async get() {\n    let request = await this.getTransactionRequest();\n    request = (0,ramda__WEBPACK_IMPORTED_MODULE_9__[\"default\"])(request);\n    request.maxFee = (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(0);\n    request.gasLimit = (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(0);\n    request.inputs = request.inputs.filter((i) => i.type !== _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.InputType.Coin);\n    const provider = this.getProvider();\n    const account = this.program.account ?? _fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.Wallet.generate({ provider });\n    const baseAssetId = await provider.getBaseAssetId();\n    const allQuantities = request.outputs.filter((o) => o.type === _fuel_ts_transactions__WEBPACK_IMPORTED_MODULE_4__.OutputType.Coin).map(({ amount, assetId }) => ({ assetId: String(assetId), amount: (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(amount) })).concat(this.requiredCoins);\n    const resources = account.generateFakeResources(allQuantities);\n    const utxoForBaseAssetId = resources.find((utxo) => utxo.assetId === baseAssetId);\n    const amountForFee = (0,_fuel_ts_math__WEBPACK_IMPORTED_MODULE_3__.bn)(\"1000000000000000\");\n    if (!utxoForBaseAssetId) {\n      const [baseAssetResource] = account.generateFakeResources([\n        { assetId: baseAssetId, amount: amountForFee }\n      ]);\n      resources.push(baseAssetResource);\n    } else {\n      utxoForBaseAssetId.amount = utxoForBaseAssetId.amount.add(amountForFee);\n    }\n    request.addResources(resources);\n    const { receipts } = await provider.assembleTx({\n      request,\n      feePayerAccount: account\n    });\n    return buildDryRunResult({\n      funcScopes: this.functionInvocationScopes,\n      callResult: { receipts },\n      isMultiCall: this.isMultiCall\n    });\n  }\n  getProvider() {\n    const provider = this.program.provider;\n    return provider;\n  }\n  /**\n   * In case the gasLimit is *not* set by the user, this method sets a default value.\n   */\n  setDefaultTxParams(transactionRequest, gasUsed, maxFee) {\n    const gasLimitSpecified = (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.isDefined)(this.txParameters?.gasLimit) || this.hasCallParamsGasLimit;\n    const maxFeeSpecified = (0,_fuel_ts_utils__WEBPACK_IMPORTED_MODULE_5__.isDefined)(this.txParameters?.maxFee);\n    const { gasLimit: setGasLimit, maxFee: setMaxFee } = transactionRequest;\n    if (!gasLimitSpecified) {\n      transactionRequest.gasLimit = gasUsed;\n    } else if (setGasLimit.lt(gasUsed)) {\n      throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(\n        _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.GAS_LIMIT_TOO_LOW,\n        `Gas limit '${setGasLimit}' is lower than the required: '${gasUsed}'.`\n      );\n    }\n    if (!maxFeeSpecified) {\n      transactionRequest.maxFee = maxFee;\n    } else if (maxFee.gt(setMaxFee)) {\n      throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(\n        _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.MAX_FEE_TOO_LOW,\n        `Max fee '${setMaxFee}' is lower than the required: '${maxFee}'.`\n      );\n    }\n  }\n};\n\n// src/functions/invocation-scope.ts\nvar FunctionInvocationScope = class extends BaseInvocationScope {\n  static {\n    __name(this, \"FunctionInvocationScope\");\n  }\n  func;\n  callParameters;\n  forward;\n  args;\n  /**\n   * Constructs an instance of FunctionInvocationScope.\n   *\n   * @param program - The program.\n   * @param func - The function fragment.\n   * @param args - The arguments.\n   */\n  constructor(program, func, args) {\n    super(program, false);\n    this.func = func;\n    this.args = args || [];\n    this.setArguments(...args);\n    super.addCall(this);\n  }\n  /**\n   * Gets the call configuration.\n   *\n   * @returns The call configuration.\n   */\n  getCallConfig() {\n    return {\n      func: this.func,\n      program: this.program,\n      callParameters: this.callParameters,\n      txParameters: this.txParameters,\n      forward: this.forward,\n      args: this.args,\n      externalAbis: this.externalAbis\n    };\n  }\n  /**\n   * Sets the arguments for the function invocation.\n   *\n   * @param args - The arguments.\n   * @returns The instance of FunctionInvocationScope.\n   */\n  setArguments(...args) {\n    this.args = args || [];\n    return this;\n  }\n  /**\n   * Sets the call parameters for the function invocation.\n   *\n   * @param callParams - The call parameters.\n   * @returns The instance of FunctionInvocationScope.\n   * @throws If the function is not payable and forward is set.\n   */\n  callParams(callParams) {\n    if (!this.hasCallParamsGasLimit && callParams?.gasLimit !== void 0) {\n      this.hasCallParamsGasLimit = true;\n    }\n    this.callParameters = callParams;\n    if (callParams?.forward) {\n      if (!this.func.attributes.find((attr) => attr.name === \"payable\")) {\n        throw new _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.FuelError(\n          _fuel_ts_errors__WEBPACK_IMPORTED_MODULE_1__.ErrorCode.TRANSACTION_ERROR,\n          `The target function ${this.func.name} cannot accept forwarded funds as it's not marked as 'payable'.`\n        );\n      }\n      this.forward = (0,_fuel_ts_account__WEBPACK_IMPORTED_MODULE_0__.coinQuantityfy)(callParams.forward);\n    }\n    this.setArguments(...this.args);\n    this.updateRequiredCoins();\n    return this;\n  }\n};\n\n// src/functions/multicall-scope.ts\nvar MultiCallInvocationScope = class extends BaseInvocationScope {\n  static {\n    __name(this, \"MultiCallInvocationScope\");\n  }\n  /**\n   * Constructs an instance of MultiCallInvocationScope.\n   *\n   * @param contract - The contract.\n   * @param funcScopes - An array of function invocation scopes.\n   */\n  constructor(contract, funcScopes) {\n    super(contract, true);\n    this.addCalls(funcScopes);\n  }\n  /**\n   * Adds a single function invocation scope to the multi-call invocation scope.\n   *\n   * @param funcScope - The function invocation scope.\n   * @returns The instance of MultiCallInvocationScope.\n   */\n  addCall(funcScope) {\n    return super.addCalls([funcScope]);\n  }\n  /**\n   * Adds multiple function invocation scopes to the multi-call invocation scope.\n   *\n   * @param funcScopes - An array of function invocation scopes.\n   * @returns The instance of MultiCallInvocationScope.\n   */\n  addCalls(funcScopes) {\n    return super.addCalls(funcScopes);\n  }\n};\n\n// src/contract.ts\n\n\nvar Contract = class {\n  static {\n    __name(this, \"Contract\");\n  }\n  /**\n   * The unique contract identifier.\n   */\n  id;\n  /**\n   * The provider for interacting with the contract.\n   */\n  provider;\n  /**\n   * The contract's ABI interface.\n   */\n  interface;\n  /**\n   * The account associated with the contract, if available.\n   */\n  account;\n  /**\n   * A collection of functions available on the contract.\n   */\n  functions = {};\n  /**\n   * Creates an instance of the Contract class.\n   *\n   * @param id - The contract's address.\n   * @param abi - The contract's ABI (JSON ABI or Interface instance).\n   * @param accountOrProvider - The account or provider for interaction.\n   */\n  constructor(id, abi, accountOrProvider) {\n    this.interface = abi instanceof _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.Interface ? abi : new _fuel_ts_abi_coder__WEBPACK_IMPORTED_MODULE_7__.Interface(abi);\n    this.id = new _fuel_ts_address__WEBPACK_IMPORTED_MODULE_2__.Address(id);\n    if (accountOrProvider && \"provider\" in accountOrProvider) {\n      this.provider = accountOrProvider.provider;\n      this.account = accountOrProvider;\n    } else {\n      this.provider = accountOrProvider;\n      this.account = null;\n    }\n    Object.keys(this.interface.functions).forEach((name) => {\n      const fragment = this.interface.getFunction(name);\n      Object.defineProperty(this.functions, fragment.name, {\n        value: this.buildFunction(fragment),\n        writable: false\n      });\n    });\n  }\n  /**\n   * Build a function invocation scope for the provided function fragment.\n   *\n   * @param func - The function fragment to build a scope for.\n   * @returns A function that creates a FunctionInvocationScope.\n   */\n  buildFunction(func) {\n    return (() => {\n      const funcInvocationScopeCreator = /* @__PURE__ */ __name((...args) => new FunctionInvocationScope(this, func, args), \"funcInvocationScopeCreator\");\n      Object.defineProperty(funcInvocationScopeCreator, \"isReadOnly\", {\n        value: /* @__PURE__ */ __name(() => func.isReadOnly(), \"value\"),\n        writable: false\n      });\n      return funcInvocationScopeCreator;\n    })();\n  }\n  /**\n   * Create a multi-call invocation scope for the provided function invocation scopes.\n   *\n   * @param calls - An array of FunctionInvocationScopes to execute in a batch.\n   * @returns A MultiCallInvocationScope instance.\n   */\n  multiCall(calls) {\n    return new MultiCallInvocationScope(this, calls);\n  }\n  /**\n   * Get the balance for a given asset ID for this contract.\n   *\n   * @param assetId - The specified asset ID.\n   * @returns The balance of the contract for the specified asset.\n   */\n  getBalance(assetId) {\n    return this.provider.getContractBalance(this.id, assetId);\n  }\n};\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQGZ1ZWwtdHMrcHJvZ3JhbUAwLjEwMS4xX3ZpdGVzdEAzLjIuNF9AdHlwZXMrZGVidWdANC4xLjEyX0B0eXBlcytub2RlQDI0LjcuMl9qaXRpQDIuNi4xXzZlNzUzZjFiODFiODhkMmMzOTE1MDhmYjc5YWIwOGQxL25vZGVfbW9kdWxlcy9AZnVlbC10cy9wcm9ncmFtL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBLDREQUE0RCwyQkFBMkI7O0FBRXZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDcUU7QUFDZDtBQUN2RDtBQUNBO0FBQ0EsY0FBYyxzREFBUyxDQUFDLHNEQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdCQUF3QjtBQUNwQztBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBLEdBQUcsSUFBSTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMkJBQTJCO0FBQ3JDLFNBQVMsZ0VBQWM7QUFDdkIsQ0FBQztBQUNEO0FBQ0EsVUFBVSwyQ0FBMkM7QUFDckQ7QUFDQSxhQUFhO0FBQ2I7QUFDQSxVQUFVLDJCQUEyQjtBQUNyQyxTQUFTLG1FQUFpQixHQUFHLDJEQUEyRDtBQUN4RixDQUFDOztBQUVEO0FBQ2tEO0FBQ2lDOztBQUVuRjtBQU0wQjtBQUNpQjtBQUN3QztBQUN6QztBQUNxQztBQUNwQztBQUNMO0FBQ1I7O0FBRTlCO0FBTzRCO0FBQzJCO0FBQzRCO0FBQ3RDO0FBQ3VCO0FBQ007QUFDckM7O0FBRXJDO0FBQ2lEO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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cnMveW91c3VrZS9NeVByb2plY3QvbXktbmV4dXMtYXBwL25vZGVfbW9kdWxlcy8ucG5wbS9AZnVlbC10cytwcm9ncmFtQDAuMTAxLjFfdml0ZXN0QDMuMi40X0B0eXBlcytkZWJ1Z0A0LjEuMTJfQHR5cGVzK25vZGVAMjQuNy4yX2ppdGlAMi42LjFfNmU3NTNmMWI4MWI4OGQyYzM5MTUwOGZiNzlhYjA4ZDEvbm9kZV9tb2R1bGVzL0BmdWVsLXRzL3Byb2dyYW0vZGlzdC9pbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX25hbWUgPSAodGFyZ2V0LCB2YWx1ZSkgPT4gX19kZWZQcm9wKHRhcmdldCwgXCJuYW1lXCIsIHsgdmFsdWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9KTtcblxuLy8gc3JjL3R5cGVzLnRzXG52YXIgQWJzdHJhY3RQcm9ncmFtID0gY2xhc3Mge1xuICBzdGF0aWMge1xuICAgIF9fbmFtZSh0aGlzLCBcIkFic3RyYWN0UHJvZ3JhbVwiKTtcbiAgfVxufTtcbnZhciBBYnN0cmFjdENvbnRyYWN0ID0gY2xhc3MgZXh0ZW5kcyBBYnN0cmFjdFByb2dyYW0ge1xuICBzdGF0aWMge1xuICAgIF9fbmFtZSh0aGlzLCBcIkFic3RyYWN0Q29udHJhY3RcIik7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy50c1xuaW1wb3J0IHsgZ2V0QWxsRGVjb2RlZExvZ3MsIGdldERlY29kZWRMb2dzIH0gZnJvbSBcIkBmdWVsLXRzL2FjY291bnRcIjtcbmltcG9ydCB7IEVycm9yQ29kZSwgRnVlbEVycm9yIH0gZnJvbSBcIkBmdWVsLXRzL2Vycm9yc1wiO1xuZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbWVzc2FnZSkge1xuICBpZiAoIWNvbmRpdGlvbikge1xuICAgIHRocm93IG5ldyBGdWVsRXJyb3IoRXJyb3JDb2RlLlRSQU5TQUNUSU9OX0VSUk9SLCBtZXNzYWdlKTtcbiAgfVxufVxuX19uYW1lKGFzc2VydCwgXCJhc3NlcnRcIik7XG5mdW5jdGlvbiBnZXRBYmlzRnJvbUFsbENhbGxzKGZ1bmN0aW9uU2NvcGVzKSB7XG4gIHJldHVybiBmdW5jdGlvblNjb3Blcy5yZWR1Y2UoKGFjYywgZnVuY1Njb3BlLCBpKSA9PiB7XG4gICAgY29uc3QgeyBwcm9ncmFtLCBleHRlcm5hbEFiaXMgfSA9IGZ1bmNTY29wZS5nZXRDYWxsQ29uZmlnKCk7XG4gICAgaWYgKGkgPT09IDApIHtcbiAgICAgIGFjYy5tYWluID0gcHJvZ3JhbS5pbnRlcmZhY2UuanNvbkFiaTtcbiAgICAgIGFjYy5vdGhlckNvbnRyYWN0c0FiaXMgPSB7fTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWNjLm90aGVyQ29udHJhY3RzQWJpc1twcm9ncmFtLmlkLnRvQjI1NigpXSA9IHByb2dyYW0uaW50ZXJmYWNlLmpzb25BYmk7XG4gICAgfVxuICAgIGFjYy5vdGhlckNvbnRyYWN0c0FiaXMgPSB7IC4uLmFjYy5vdGhlckNvbnRyYWN0c0FiaXMsIC4uLmV4dGVybmFsQWJpcyB9O1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbn1cbl9fbmFtZShnZXRBYmlzRnJvbUFsbENhbGxzLCBcImdldEFiaXNGcm9tQWxsQ2FsbHNcIik7XG52YXIgZ2V0UmVzdWx0TG9ncyA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKHJlY2VpcHRzLCBtYWluQ2FsbENvbmZpZywgZnVuY3Rpb25TY29wZXMpID0+IHtcbiAgaWYgKCFtYWluQ2FsbENvbmZpZykge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjb25zdCB7IG1haW4sIG90aGVyQ29udHJhY3RzQWJpcyB9ID0gZ2V0QWJpc0Zyb21BbGxDYWxscyhmdW5jdGlvblNjb3Blcyk7XG4gIHJldHVybiBnZXREZWNvZGVkTG9ncyhyZWNlaXB0cywgbWFpbiwgb3RoZXJDb250cmFjdHNBYmlzKTtcbn0sIFwiZ2V0UmVzdWx0TG9nc1wiKTtcbnZhciBnZXRBbGxSZXN1bHRMb2dzID0gLyogQF9fUFVSRV9fICovIF9fbmFtZSgob3B0cykgPT4ge1xuICBjb25zdCB7IHJlY2VpcHRzLCBtYWluQ2FsbENvbmZpZywgZnVuY3Rpb25TY29wZXMgfSA9IG9wdHM7XG4gIGlmICghbWFpbkNhbGxDb25maWcpIHtcbiAgICByZXR1cm4geyBsb2dzOiBbXSwgZ3JvdXBlZExvZ3M6IHt9IH07XG4gIH1cbiAgY29uc3QgeyBtYWluLCBvdGhlckNvbnRyYWN0c0FiaXMgfSA9IGdldEFiaXNGcm9tQWxsQ2FsbHMoZnVuY3Rpb25TY29wZXMpO1xuICByZXR1cm4gZ2V0QWxsRGVjb2RlZExvZ3MoeyByZWNlaXB0cywgbWFpbkFiaTogbWFpbiwgZXh0ZXJuYWxBYmlzOiBvdGhlckNvbnRyYWN0c0FiaXMgfSk7XG59LCBcImdldEFsbFJlc3VsdExvZ3NcIik7XG5cbi8vIHNyYy9mdW5jdGlvbnMvaW52b2NhdGlvbi1zY29wZS50c1xuaW1wb3J0IHsgY29pblF1YW50aXR5ZnkgfSBmcm9tIFwiQGZ1ZWwtdHMvYWNjb3VudFwiO1xuaW1wb3J0IHsgRXJyb3JDb2RlIGFzIEVycm9yQ29kZTUsIEZ1ZWxFcnJvciBhcyBGdWVsRXJyb3I1IH0gZnJvbSBcIkBmdWVsLXRzL2Vycm9yc1wiO1xuXG4vLyBzcmMvZnVuY3Rpb25zL2Jhc2UtaW52b2NhdGlvbi1zY29wZS50c1xuaW1wb3J0IHtcbiAgbWVyZ2VRdWFudGl0aWVzLFxuICBTY3JpcHRUcmFuc2FjdGlvblJlcXVlc3QsXG4gIFdhbGxldCxcbiAgc2V0QW5kVmFsaWRhdGVHYXNBbmRGZWVGb3JBc3NlbWJsZWRUeFxufSBmcm9tIFwiQGZ1ZWwtdHMvYWNjb3VudFwiO1xuaW1wb3J0IHsgQWRkcmVzcyB9IGZyb20gXCJAZnVlbC10cy9hZGRyZXNzXCI7XG5pbXBvcnQgeyBFcnJvckNvZGUgYXMgRXJyb3JDb2RlNCwgRnVlbEVycm9yIGFzIEZ1ZWxFcnJvcjQgfSBmcm9tIFwiQGZ1ZWwtdHMvZXJyb3JzXCI7XG5pbXBvcnQgeyBibiBhcyBibjIgfSBmcm9tIFwiQGZ1ZWwtdHMvbWF0aFwiO1xuaW1wb3J0IHsgSW5wdXRUeXBlLCBPdXRwdXRUeXBlLCBUcmFuc2FjdGlvblR5cGUgfSBmcm9tIFwiQGZ1ZWwtdHMvdHJhbnNhY3Rpb25zXCI7XG5pbXBvcnQgeyBpc0RlZmluZWQgfSBmcm9tIFwiQGZ1ZWwtdHMvdXRpbHNcIjtcbmltcG9ydCAqIGFzIGFzbTIgZnJvbSBcIkBmdWVscy92bS1hc21cIjtcbmltcG9ydCB7IGNsb25lIH0gZnJvbSBcInJhbWRhXCI7XG5cbi8vIHNyYy9jb250cmFjdC1jYWxsLXNjcmlwdC50c1xuaW1wb3J0IHtcbiAgV09SRF9TSVpFIGFzIFdPUkRfU0laRTIsXG4gIEIyNTZDb2RlcixcbiAgQVNTRVRfSURfTEVOIGFzIEFTU0VUX0lEX0xFTjIsXG4gIEJpZ051bWJlckNvZGVyLFxuICBDT05UUkFDVF9JRF9MRU4gYXMgQ09OVFJBQ1RfSURfTEVOMlxufSBmcm9tIFwiQGZ1ZWwtdHMvYWJpLWNvZGVyXCI7XG5pbXBvcnQgeyBaZXJvQnl0ZXMzMiB9IGZyb20gXCJAZnVlbC10cy9hZGRyZXNzL2NvbmZpZ3NcIjtcbmltcG9ydCB7IEVycm9yQ29kZSBhcyBFcnJvckNvZGUzLCBGdWVsRXJyb3IgYXMgRnVlbEVycm9yMyB9IGZyb20gXCJAZnVlbC10cy9lcnJvcnNcIjtcbmltcG9ydCB7IGJuLCB0b051bWJlciB9IGZyb20gXCJAZnVlbC10cy9tYXRoXCI7XG5pbXBvcnQgeyBSZWNlaXB0VHlwZSBhcyBSZWNlaXB0VHlwZTIgfSBmcm9tIFwiQGZ1ZWwtdHMvdHJhbnNhY3Rpb25zXCI7XG5pbXBvcnQgeyBjb25jYXQgYXMgY29uY2F0MiwgYXJyYXlpZnkgYXMgYXJyYXlpZnkyIH0gZnJvbSBcIkBmdWVsLXRzL3V0aWxzXCI7XG5pbXBvcnQgKiBhcyBhc20gZnJvbSBcIkBmdWVscy92bS1hc21cIjtcblxuLy8gc3JjL2luc3RydWN0aW9uLXNldC50c1xuaW1wb3J0IHsgY29uY2F0LCBoZXhsaWZ5IH0gZnJvbSBcIkBmdWVsLXRzL3V0aWxzXCI7XG52YXIgSW5zdHJ1Y3Rpb25TZXQgPSBjbGFzcyB7XG4gIHN0YXRpYyB7XG4gICAgX19uYW1lKHRoaXMsIFwiSW5zdHJ1Y3Rpb25TZXRcIik7XG4gIH1cbiAgI29wZXJhdGlvbnM7XG4gIGNvbnN0cnVjdG9yKC4uLmFyZ3MpIHtcbiAgICB0aGlzLiNvcGVyYXRpb25zID0gYXJncyB8fCBbXTtcbiAgfVxuICBlbnRyaWVzKCkge1xuICAgIHJldHVybiB0aGlzLiNvcGVyYXRpb25zO1xuICB9XG4gIHB1c2goLi4uYXJncykge1xuICAgIHRoaXMuI29wZXJhdGlvbnMucHVzaCguLi5hcmdzKTtcbiAgfVxuICBjb25jYXQob3BzKSB7XG4gICAgcmV0dXJuIHRoaXMuI29wZXJhdGlvbnMuY29uY2F0KG9wcyk7XG4gIH1cbiAgZXh0ZW5kKG9wcykge1xuICAgIHRoaXMuI29wZXJhdGlvbnMucHVzaCguLi5vcHMpO1xuICB9XG4gIHRvQnl0ZXMoKSB7XG4gICAgcmV0dXJuIGNvbmNhdChcbiAgICAgIHRoaXMuI29wZXJhdGlvbnMucmVkdWNlKChpbnN0cnVjdGlvbnMsIGxpbmUpID0+IHtcbiAgICAgICAgaW5zdHJ1Y3Rpb25zLnB1c2gobGluZS50b19ieXRlcygpKTtcbiAgICAgICAgcmV0dXJuIGluc3RydWN0aW9ucztcbiAgICAgIH0sIFtdKVxuICAgICk7XG4gIH1cbiAgdG9IZXgoKSB7XG4gICAgcmV0dXJuIGhleGxpZnkodGhpcy50b0J5dGVzKCkpO1xuICB9XG4gIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiBgUHJvZ3JhbTpcbiR7SlNPTi5zdHJpbmdpZnkodGhpcy4jb3BlcmF0aW9ucywgbnVsbCwgMil9YDtcbiAgfVxuICBieXRlTGVuZ3RoKCkge1xuICAgIHJldHVybiB0aGlzLnRvQnl0ZXMoKS5ieXRlTGVuZ3RoO1xuICB9XG59O1xuXG4vLyBzcmMvc2NyaXB0LXJlcXVlc3QudHNcbmltcG9ydCB7XG4gIEFTU0VUX0lEX0xFTixcbiAgQ09OVFJBQ1RfSURfTEVOLFxuICBTQ1JJUFRfRklYRURfU0laRSxcbiAgV09SRF9TSVpFLFxuICBjYWxjdWxhdGVWbVR4TWVtb3J5XG59IGZyb20gXCJAZnVlbC10cy9hYmktY29kZXJcIjtcbmltcG9ydCB7IGV4dHJhY3RUeEVycm9yIH0gZnJvbSBcIkBmdWVsLXRzL2FjY291bnRcIjtcbmltcG9ydCB7IEVycm9yQ29kZSBhcyBFcnJvckNvZGUyLCBGdWVsRXJyb3IgYXMgRnVlbEVycm9yMiB9IGZyb20gXCJAZnVlbC10cy9lcnJvcnNcIjtcbmltcG9ydCB7IFJlY2VpcHRUeXBlIH0gZnJvbSBcIkBmdWVsLXRzL3RyYW5zYWN0aW9uc1wiO1xuaW1wb3J0IHsgYXJyYXlpZnkgfSBmcm9tIFwiQGZ1ZWwtdHMvdXRpbHNcIjtcbnZhciBjYWxjdWxhdGVTY3JpcHREYXRhQmFzZU9mZnNldCA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKG1heElucHV0cykgPT4gU0NSSVBUX0ZJWEVEX1NJWkUgKyBjYWxjdWxhdGVWbVR4TWVtb3J5KHsgbWF4SW5wdXRzIH0pLCBcImNhbGN1bGF0ZVNjcmlwdERhdGFCYXNlT2Zmc2V0XCIpO1xudmFyIFBPSU5URVJfREFUQV9PRkZTRVQgPSBXT1JEX1NJWkUgKyBBU1NFVF9JRF9MRU4gKyBDT05UUkFDVF9JRF9MRU4gKyBXT1JEX1NJWkUgKyBXT1JEX1NJWkU7XG5mdW5jdGlvbiBjYWxsUmVzdWx0VG9TY3JpcHRSZXN1bHQoY2FsbFJlc3VsdCkge1xuICBjb25zdCByZWNlaXB0cyA9IFsuLi5jYWxsUmVzdWx0LnJlY2VpcHRzXTtcbiAgbGV0IHNjcmlwdFJlc3VsdFJlY2VpcHQ7XG4gIGxldCByZXR1cm5SZWNlaXB0O1xuICByZWNlaXB0cy5mb3JFYWNoKChyZWNlaXB0KSA9PiB7XG4gICAgaWYgKHJlY2VpcHQudHlwZSA9PT0gUmVjZWlwdFR5cGUuU2NyaXB0UmVzdWx0KSB7XG4gICAgICBzY3JpcHRSZXN1bHRSZWNlaXB0ID0gcmVjZWlwdDtcbiAgICB9IGVsc2UgaWYgKHJlY2VpcHQudHlwZSA9PT0gUmVjZWlwdFR5cGUuUmV0dXJuIHx8IHJlY2VpcHQudHlwZSA9PT0gUmVjZWlwdFR5cGUuUmV0dXJuRGF0YSB8fCByZWNlaXB0LnR5cGUgPT09IFJlY2VpcHRUeXBlLlJldmVydCkge1xuICAgICAgcmV0dXJuUmVjZWlwdCA9IHJlY2VpcHQ7XG4gICAgfVxuICB9KTtcbiAgaWYgKCFzY3JpcHRSZXN1bHRSZWNlaXB0IHx8ICFyZXR1cm5SZWNlaXB0KSB7XG4gICAgdGhyb3cgbmV3IEZ1ZWxFcnJvcjIoRXJyb3JDb2RlMi5TQ1JJUFRfUkVWRVJURUQsIGBUcmFuc2FjdGlvbiByZXZlcnRlZC5gKTtcbiAgfVxuICBjb25zdCBzY3JpcHRSZXN1bHQgPSB7XG4gICAgY29kZTogc2NyaXB0UmVzdWx0UmVjZWlwdC5yZXN1bHQsXG4gICAgZ2FzVXNlZDogc2NyaXB0UmVzdWx0UmVjZWlwdC5nYXNVc2VkLFxuICAgIHJlY2VpcHRzLFxuICAgIHNjcmlwdFJlc3VsdFJlY2VpcHQsXG4gICAgcmV0dXJuUmVjZWlwdCxcbiAgICBjYWxsUmVzdWx0XG4gIH07XG4gIHJldHVybiBzY3JpcHRSZXN1bHQ7XG59XG5fX25hbWUoY2FsbFJlc3VsdFRvU2NyaXB0UmVzdWx0LCBcImNhbGxSZXN1bHRUb1NjcmlwdFJlc3VsdFwiKTtcbmZ1bmN0aW9uIGRlY29kZUNhbGxSZXN1bHQoY2FsbFJlc3VsdCwgZGVjb2RlciwgbG9ncyA9IFtdLCBncm91cGVkTG9ncyA9IHt9KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2NyaXB0UmVzdWx0ID0gY2FsbFJlc3VsdFRvU2NyaXB0UmVzdWx0KGNhbGxSZXN1bHQpO1xuICAgIHJldHVybiBkZWNvZGVyKHNjcmlwdFJlc3VsdCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yLmNvZGUgPT09IEVycm9yQ29kZTIuU0NSSVBUX1JFVkVSVEVEKSB7XG4gICAgICBjb25zdCBzdGF0dXNSZWFzb24gPSBjYWxsUmVzdWx0Py5kcnlSdW5TdGF0dXM/LnJlYXNvbjtcbiAgICAgIHRocm93IGV4dHJhY3RUeEVycm9yKHtcbiAgICAgICAgbG9ncyxcbiAgICAgICAgZ3JvdXBlZExvZ3MsXG4gICAgICAgIHJlY2VpcHRzOiBjYWxsUmVzdWx0LnJlY2VpcHRzLFxuICAgICAgICBzdGF0dXNSZWFzb25cbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuX19uYW1lKGRlY29kZUNhbGxSZXN1bHQsIFwiZGVjb2RlQ2FsbFJlc3VsdFwiKTtcbmZ1bmN0aW9uIGNhbGxSZXN1bHRUb0ludm9jYXRpb25SZXN1bHQoY2FsbFJlc3VsdCwgY2FsbDIsIGxvZ3MsIGdyb3VwZWRMb2dzKSB7XG4gIHJldHVybiBkZWNvZGVDYWxsUmVzdWx0KFxuICAgIGNhbGxSZXN1bHQsXG4gICAgKHNjcmlwdFJlc3VsdCkgPT4ge1xuICAgICAgaWYgKHNjcmlwdFJlc3VsdC5yZXR1cm5SZWNlaXB0LnR5cGUgPT09IFJlY2VpcHRUeXBlLlJldmVydCkge1xuICAgICAgICB0aHJvdyBuZXcgRnVlbEVycm9yMihcbiAgICAgICAgICBFcnJvckNvZGUyLlNDUklQVF9SRVZFUlRFRCxcbiAgICAgICAgICBgU2NyaXB0IFJldmVydGVkLiBMb2dzOiAke0pTT04uc3RyaW5naWZ5KGxvZ3MpfWBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGlmIChzY3JpcHRSZXN1bHQucmV0dXJuUmVjZWlwdC50eXBlICE9PSBSZWNlaXB0VHlwZS5SZXR1cm4gJiYgc2NyaXB0UmVzdWx0LnJldHVyblJlY2VpcHQudHlwZSAhPT0gUmVjZWlwdFR5cGUuUmV0dXJuRGF0YSkge1xuICAgICAgICBjb25zdCB7IHR5cGUgfSA9IHNjcmlwdFJlc3VsdC5yZXR1cm5SZWNlaXB0O1xuICAgICAgICB0aHJvdyBuZXcgRnVlbEVycm9yMihcbiAgICAgICAgICBFcnJvckNvZGUyLlNDUklQVF9SRVZFUlRFRCxcbiAgICAgICAgICBgU2NyaXB0IFJldHVybiBUeXBlIFske3R5cGV9XSBJbnZhbGlkLiBMb2dzOiAke0pTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGxvZ3MsXG4gICAgICAgICAgICBncm91cGVkTG9ncyxcbiAgICAgICAgICAgIHJlY2VpcHQ6IHNjcmlwdFJlc3VsdC5yZXR1cm5SZWNlaXB0XG4gICAgICAgICAgfSl9YFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgbGV0IHZhbHVlO1xuICAgICAgaWYgKHNjcmlwdFJlc3VsdC5yZXR1cm5SZWNlaXB0LnR5cGUgPT09IFJlY2VpcHRUeXBlLlJldHVybikge1xuICAgICAgICB2YWx1ZSA9IHNjcmlwdFJlc3VsdC5yZXR1cm5SZWNlaXB0LnZhbDtcbiAgICAgIH1cbiAgICAgIGlmIChzY3JpcHRSZXN1bHQucmV0dXJuUmVjZWlwdC50eXBlID09PSBSZWNlaXB0VHlwZS5SZXR1cm5EYXRhKSB7XG4gICAgICAgIGNvbnN0IGRlY29kZWQgPSBjYWxsMi5mdW5jLmRlY29kZU91dHB1dChzY3JpcHRSZXN1bHQucmV0dXJuUmVjZWlwdC5kYXRhKTtcbiAgICAgICAgdmFsdWUgPSBkZWNvZGVkWzBdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgbG9nc1xuICApO1xufVxuX19uYW1lKGNhbGxSZXN1bHRUb0ludm9jYXRpb25SZXN1bHQsIFwiY2FsbFJlc3VsdFRvSW52b2NhdGlvblJlc3VsdFwiKTtcbnZhciBTY3JpcHRSZXF1ZXN0ID0gY2xhc3MgX1NjcmlwdFJlcXVlc3Qge1xuICBzdGF0aWMge1xuICAgIF9fbmFtZSh0aGlzLCBcIlNjcmlwdFJlcXVlc3RcIik7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBieXRlcyBvZiB0aGUgc2NyaXB0LlxuICAgKi9cbiAgYnl0ZXM7XG4gIC8qKlxuICAgKiBBIGZ1bmN0aW9uIHRvIGVuY29kZSB0aGUgc2NyaXB0IGRhdGEuXG4gICAqL1xuICBzY3JpcHREYXRhRW5jb2RlcjtcbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gdG8gZGVjb2RlIHRoZSBzY3JpcHQgcmVzdWx0LlxuICAgKi9cbiAgc2NyaXB0UmVzdWx0RGVjb2RlcjtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIFNjcmlwdFJlcXVlc3QgY2xhc3MuXG4gICAqXG4gICAqIEBwYXJhbSBieXRlcyAtIFRoZSBieXRlcyBvZiB0aGUgc2NyaXB0LlxuICAgKiBAcGFyYW0gc2NyaXB0RGF0YUVuY29kZXIgLSBUaGUgc2NyaXB0IGRhdGEgZW5jb2RlciBmdW5jdGlvbi5cbiAgICogQHBhcmFtIHNjcmlwdFJlc3VsdERlY29kZXIgLSBUaGUgc2NyaXB0IHJlc3VsdCBkZWNvZGVyIGZ1bmN0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3IoYnl0ZXMsIHNjcmlwdERhdGFFbmNvZGVyLCBzY3JpcHRSZXN1bHREZWNvZGVyMikge1xuICAgIHRoaXMuYnl0ZXMgPSBhcnJheWlmeShieXRlcyk7XG4gICAgdGhpcy5zY3JpcHREYXRhRW5jb2RlciA9IHNjcmlwdERhdGFFbmNvZGVyO1xuICAgIHRoaXMuc2NyaXB0UmVzdWx0RGVjb2RlciA9IHNjcmlwdFJlc3VsdERlY29kZXIyO1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBzY3JpcHQgZGF0YSBvZmZzZXQgZm9yIHRoZSBnaXZlbiBieXRlcy5cbiAgICpcbiAgICogQHBhcmFtIGJ5dGVMZW5ndGggLSBUaGUgYnl0ZSBsZW5ndGggb2YgdGhlIHNjcmlwdC5cbiAgICogQHBhcmFtIG1heElucHV0cyAtIFRoZSBtYXhJbnB1dHMgdmFsdWUgZnJvbSB0aGUgY2hhaW4ncyBjb25zZW5zdXMgcGFyYW1zLlxuICAgKiBAcmV0dXJucyBUaGUgc2NyaXB0IGRhdGEgb2Zmc2V0LlxuICAgKi9cbiAgc3RhdGljIGdldFNjcmlwdERhdGFPZmZzZXRXaXRoU2NyaXB0Qnl0ZXMoYnl0ZUxlbmd0aCwgbWF4SW5wdXRzKSB7XG4gICAgY29uc3Qgc2NyaXB0RGF0YUJhc2VPZmZzZXQgPSBjYWxjdWxhdGVWbVR4TWVtb3J5KHsgbWF4SW5wdXRzIH0pICsgU0NSSVBUX0ZJWEVEX1NJWkU7XG4gICAgcmV0dXJuIHNjcmlwdERhdGFCYXNlT2Zmc2V0ICsgYnl0ZUxlbmd0aDtcbiAgfVxuICAvKipcbiAgICogR2V0cyB0aGUgc2NyaXB0IGRhdGEgb2Zmc2V0LlxuICAgKlxuICAgKiBAcGFyYW0gbWF4SW5wdXRzIC0gVGhlIG1heElucHV0cyB2YWx1ZSBmcm9tIHRoZSBjaGFpbidzIGNvbnNlbnN1cyBwYXJhbXMuXG4gICAqIEByZXR1cm5zIFRoZSBzY3JpcHQgZGF0YSBvZmZzZXQuXG4gICAqL1xuICBnZXRTY3JpcHREYXRhT2Zmc2V0KG1heElucHV0cykge1xuICAgIHJldHVybiBfU2NyaXB0UmVxdWVzdC5nZXRTY3JpcHREYXRhT2Zmc2V0V2l0aFNjcmlwdEJ5dGVzKHRoaXMuYnl0ZXMubGVuZ3RoLCBtYXhJbnB1dHMpO1xuICB9XG4gIC8qKlxuICAgKiBFbmNvZGVzIHRoZSBkYXRhIGZvciBhIHNjcmlwdCBjYWxsLlxuICAgKlxuICAgKiBAcGFyYW0gZGF0YSAtIFRoZSBzY3JpcHQgZGF0YS5cbiAgICogQHJldHVybnMgVGhlIGVuY29kZWQgZGF0YS5cbiAgICovXG4gIGVuY29kZVNjcmlwdERhdGEoZGF0YSkge1xuICAgIGNvbnN0IGNhbGxTY3JpcHQgPSB0aGlzLnNjcmlwdERhdGFFbmNvZGVyKGRhdGEpO1xuICAgIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcoY2FsbFNjcmlwdCkpIHtcbiAgICAgIHJldHVybiBjYWxsU2NyaXB0O1xuICAgIH1cbiAgICB0aGlzLmJ5dGVzID0gYXJyYXlpZnkoY2FsbFNjcmlwdC5zY3JpcHQpO1xuICAgIHJldHVybiBjYWxsU2NyaXB0LmRhdGE7XG4gIH1cbiAgLyoqXG4gICAqIERlY29kZXMgdGhlIHJlc3VsdCBvZiBhIHNjcmlwdCBjYWxsLlxuICAgKlxuICAgKiBAcGFyYW0gY2FsbFJlc3VsdCAtIFRoZSBDYWxsUmVzdWx0IGZyb20gdGhlIHNjcmlwdCBjYWxsLlxuICAgKiBAcGFyYW0gbG9ncyAtIE9wdGlvbmFsIGxvZ3MgYXNzb2NpYXRlZCB3aXRoIHRoZSBkZWNvZGluZy5cbiAgICogQHJldHVybnMgVGhlIGRlY29kZWQgcmVzdWx0LlxuICAgKi9cbiAgZGVjb2RlQ2FsbFJlc3VsdChjYWxsUmVzdWx0LCBsb2dzID0gW10pIHtcbiAgICByZXR1cm4gZGVjb2RlQ2FsbFJlc3VsdChjYWxsUmVzdWx0LCB0aGlzLnNjcmlwdFJlc3VsdERlY29kZXIsIGxvZ3MpO1xuICB9XG59O1xuXG4vLyBzcmMvY29udHJhY3QtY2FsbC1zY3JpcHQudHNcbnZhciBERUZBVUxUX09QQ09ERV9QQVJBTVMgPSB7XG4gIGFzc2V0SWRPZmZzZXQ6IDAsXG4gIGFtb3VudE9mZnNldDogMCxcbiAgZ2FzRm9yd2FyZGVkT2Zmc2V0OiAwLFxuICBjYWxsRGF0YU9mZnNldDogMFxufTtcbnZhciBTQ1JJUFRfV1JBUFBFUl9DT05UUkFDVF9JRCA9IFplcm9CeXRlczMyO1xudmFyIGdldFNpbmdsZUNhbGxJbnN0cnVjdGlvbnMgPSAvKiBAX19QVVJFX18gKi8gX19uYW1lKCh7XG4gIGNhbGxEYXRhT2Zmc2V0LFxuICBnYXNGb3J3YXJkZWRPZmZzZXQsXG4gIGFtb3VudE9mZnNldCxcbiAgYXNzZXRJZE9mZnNldFxufSkgPT4ge1xuICBjb25zdCBpbnN0ID0gbmV3IEluc3RydWN0aW9uU2V0KFxuICAgIGFzbS5tb3ZpKDE2LCBjYWxsRGF0YU9mZnNldCksXG4gICAgYXNtLm1vdmkoMTcsIGFtb3VudE9mZnNldCksXG4gICAgYXNtLmx3KDE3LCAxNywgMCksXG4gICAgYXNtLm1vdmkoMTgsIGFzc2V0SWRPZmZzZXQpXG4gICk7XG4gIGlmIChnYXNGb3J3YXJkZWRPZmZzZXQpIHtcbiAgICBpbnN0LnB1c2goXG4gICAgICBhc20ubW92aSgxOSwgZ2FzRm9yd2FyZGVkT2Zmc2V0KSxcbiAgICAgIGFzbS5sdygxOSwgMTksIDApLFxuICAgICAgYXNtLmNhbGwoMTYsIDE3LCAxOCwgMTkpXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBpbnN0LnB1c2goYXNtLmNhbGwoMTYsIDE3LCAxOCwgYXNtLlJlZ0lkLmNnYXMoKS50b191OCgpKSk7XG4gIH1cbiAgcmV0dXJuIGluc3Q7XG59LCBcImdldFNpbmdsZUNhbGxJbnN0cnVjdGlvbnNcIik7XG5mdW5jdGlvbiBnZXRJbnN0cnVjdGlvbnMob2Zmc2V0cykge1xuICBpZiAoIW9mZnNldHMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KCk7XG4gIH1cbiAgY29uc3QgbXVsdGlDYWxsSW5zdHJ1Y3Rpb25zID0gbmV3IEluc3RydWN0aW9uU2V0KCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgb2Zmc2V0cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIG11bHRpQ2FsbEluc3RydWN0aW9ucy5leHRlbmQoZ2V0U2luZ2xlQ2FsbEluc3RydWN0aW9ucyhvZmZzZXRzW2ldKS5lbnRyaWVzKCkpO1xuICB9XG4gIG11bHRpQ2FsbEluc3RydWN0aW9ucy5wdXNoKGFzbS5yZXQoMSkpO1xuICByZXR1cm4gbXVsdGlDYWxsSW5zdHJ1Y3Rpb25zLnRvQnl0ZXMoKTtcbn1cbl9fbmFtZShnZXRJbnN0cnVjdGlvbnMsIFwiZ2V0SW5zdHJ1Y3Rpb25zXCIpO1xudmFyIGlzUmV0dXJuVHlwZSA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKHR5cGUpID0+IHR5cGUgPT09IFJlY2VpcHRUeXBlMi5SZXR1cm4gfHwgdHlwZSA9PT0gUmVjZWlwdFR5cGUyLlJldHVybkRhdGEsIFwiaXNSZXR1cm5UeXBlXCIpO1xudmFyIGdldE1haW5DYWxsUmVjZWlwdCA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKHJlY2VpcHRzLCBjb250cmFjdElkKSA9PiByZWNlaXB0cy5maW5kKFxuICAoeyB0eXBlLCBpZCwgdG8gfSkgPT4gdHlwZSA9PT0gUmVjZWlwdFR5cGUyLkNhbGwgJiYgaWQgPT09IFNDUklQVF9XUkFQUEVSX0NPTlRSQUNUX0lEICYmIHRvID09PSBjb250cmFjdElkXG4pLCBcImdldE1haW5DYWxsUmVjZWlwdFwiKTtcbnZhciBzY3JpcHRSZXN1bHREZWNvZGVyID0gLyogQF9fUFVSRV9fICovIF9fbmFtZSgoY29udHJhY3RJZCkgPT4gKHJlc3VsdCkgPT4ge1xuICBpZiAodG9OdW1iZXIocmVzdWx0LmNvZGUpICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IEZ1ZWxFcnJvcjMoRXJyb3JDb2RlMy5TQ1JJUFRfUkVWRVJURUQsIGBUcmFuc2FjdGlvbiByZXZlcnRlZC5gKTtcbiAgfVxuICBjb25zdCBtYWluQ2FsbFJlc3VsdCA9IGdldE1haW5DYWxsUmVjZWlwdChcbiAgICByZXN1bHQucmVjZWlwdHMsXG4gICAgY29udHJhY3RJZC50b0IyNTYoKVxuICApO1xuICBjb25zdCBtYWluQ2FsbEluc3RydWN0aW9uU3RhcnQgPSBibihtYWluQ2FsbFJlc3VsdD8uaXMpO1xuICBjb25zdCByZWNlaXB0cyA9IHJlc3VsdC5yZWNlaXB0cztcbiAgcmV0dXJuIHJlY2VpcHRzLmZpbHRlcigoeyB0eXBlIH0pID0+IGlzUmV0dXJuVHlwZSh0eXBlKSkuZmxhdE1hcCgocmVjZWlwdCkgPT4ge1xuICAgIGlmICghbWFpbkNhbGxJbnN0cnVjdGlvblN0YXJ0LmVxKGJuKHJlY2VpcHQuaXMpKSkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBpZiAocmVjZWlwdC50eXBlID09PSBSZWNlaXB0VHlwZTIuUmV0dXJuKSB7XG4gICAgICByZXR1cm4gW25ldyBCaWdOdW1iZXJDb2RlcihcInU2NFwiKS5lbmNvZGUocmVjZWlwdC52YWwpXTtcbiAgICB9XG4gICAgaWYgKHJlY2VpcHQudHlwZSA9PT0gUmVjZWlwdFR5cGUyLlJldHVybkRhdGEpIHtcbiAgICAgIGNvbnN0IGVuY29kZWRTY3JpcHRSZXR1cm4gPSBhcnJheWlmeTIocmVjZWlwdC5kYXRhKTtcbiAgICAgIHJldHVybiBbZW5jb2RlZFNjcmlwdFJldHVybl07XG4gICAgfVxuICAgIHJldHVybiBbbmV3IFVpbnQ4QXJyYXkoKV07XG4gIH0pO1xufSwgXCJzY3JpcHRSZXN1bHREZWNvZGVyXCIpO1xudmFyIGRlY29kZUNvbnRyYWN0Q2FsbFNjcmlwdFJlc3VsdCA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKGNhbGxSZXN1bHQsIGNvbnRyYWN0SWQsIGxvZ3MgPSBbXSwgZ3JvdXBlZExvZ3MgPSB7fSkgPT4gZGVjb2RlQ2FsbFJlc3VsdChjYWxsUmVzdWx0LCBzY3JpcHRSZXN1bHREZWNvZGVyKGNvbnRyYWN0SWQpLCBsb2dzLCBncm91cGVkTG9ncyksIFwiZGVjb2RlQ29udHJhY3RDYWxsU2NyaXB0UmVzdWx0XCIpO1xudmFyIGdldENhbGxJbnN0cnVjdGlvbnNMZW5ndGggPSAvKiBAX19QVVJFX18gKi8gX19uYW1lKChjb250cmFjdENhbGxzKSA9PiBjb250cmFjdENhbGxzLnJlZHVjZShcbiAgKHN1bSwgY2FsbDIpID0+IHtcbiAgICBjb25zdCBvZmZzZXQgPSB7IC4uLkRFRkFVTFRfT1BDT0RFX1BBUkFNUyB9O1xuICAgIGlmIChjYWxsMi5nYXMpIHtcbiAgICAgIG9mZnNldC5nYXNGb3J3YXJkZWRPZmZzZXQgPSAxO1xuICAgIH1cbiAgICByZXR1cm4gc3VtICsgZ2V0U2luZ2xlQ2FsbEluc3RydWN0aW9ucyhvZmZzZXQpLmJ5dGVMZW5ndGgoKTtcbiAgfSxcbiAgYXNtLkluc3RydWN0aW9uLnNpemUoKVxuICAvLyBwbGFjZWhvbGRlciBmb3Igc2luZ2xlIFJFVCBpbnN0cnVjdGlvbiB3aGljaCBpcyBhZGRlZCBsYXRlclxuKSwgXCJnZXRDYWxsSW5zdHJ1Y3Rpb25zTGVuZ3RoXCIpO1xudmFyIGdldENvbnRyYWN0Q2FsbFNjcmlwdCA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKGZ1bmN0aW9uU2NvcGVzLCBtYXhJbnB1dHMpID0+IG5ldyBTY3JpcHRSZXF1ZXN0KFxuICAvLyBTY3JpcHQgdG8gY2FsbCB0aGUgY29udHJhY3QsIHN0YXJ0IHdpdGggc3R1YiBzaXplIG1hdGNoaW5nIGxlbmd0aCBvZiBjYWxsc1xuICBnZXRJbnN0cnVjdGlvbnMobmV3IEFycmF5KGZ1bmN0aW9uU2NvcGVzLmxlbmd0aCkuZmlsbChERUZBVUxUX09QQ09ERV9QQVJBTVMpKSxcbiAgKGNvbnRyYWN0Q2FsbHMpID0+IHtcbiAgICBjb25zdCBUT1RBTF9DQUxMUyA9IGNvbnRyYWN0Q2FsbHMubGVuZ3RoO1xuICAgIGlmIChUT1RBTF9DQUxMUyA9PT0gMCkge1xuICAgICAgcmV0dXJuIHsgZGF0YTogbmV3IFVpbnQ4QXJyYXkoKSwgc2NyaXB0OiBuZXcgVWludDhBcnJheSgpIH07XG4gICAgfVxuICAgIGNvbnN0IGNhbGxJbnN0cnVjdGlvbnNMZW5ndGggPSBnZXRDYWxsSW5zdHJ1Y3Rpb25zTGVuZ3RoKGNvbnRyYWN0Q2FsbHMpO1xuICAgIGNvbnN0IHBhZGRpbmdMZW5ndGggPSAoOCAtIGNhbGxJbnN0cnVjdGlvbnNMZW5ndGggJSA4KSAlIDg7XG4gICAgY29uc3QgcGFkZGVkSW5zdHJ1Y3Rpb25zTGVuZ3RoID0gY2FsbEluc3RydWN0aW9uc0xlbmd0aCArIHBhZGRpbmdMZW5ndGg7XG4gICAgY29uc3QgZGF0YU9mZnNldCA9IGNhbGN1bGF0ZVNjcmlwdERhdGFCYXNlT2Zmc2V0KG1heElucHV0cy50b051bWJlcigpKSArIHBhZGRlZEluc3RydWN0aW9uc0xlbmd0aDtcbiAgICBjb25zdCBwYXJhbU9mZnNldHMgPSBbXTtcbiAgICBsZXQgc2VnbWVudE9mZnNldCA9IGRhdGFPZmZzZXQ7XG4gICAgY29uc3Qgc2NyaXB0RGF0YSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgVE9UQUxfQ0FMTFM7IGkgKz0gMSkge1xuICAgICAgY29uc3QgY2FsbDIgPSBjb250cmFjdENhbGxzW2ldO1xuICAgICAgY29uc3QgYW1vdW50T2Zmc2V0ID0gc2VnbWVudE9mZnNldDtcbiAgICAgIGNvbnN0IGFzc2V0SWRPZmZzZXQgPSBhbW91bnRPZmZzZXQgKyBXT1JEX1NJWkUyO1xuICAgICAgY29uc3QgY2FsbERhdGFPZmZzZXQgPSBhc3NldElkT2Zmc2V0ICsgQVNTRVRfSURfTEVOMjtcbiAgICAgIGNvbnN0IGVuY29kZWRTZWxlY3Rvck9mZnNldCA9IGNhbGxEYXRhT2Zmc2V0ICsgQ09OVFJBQ1RfSURfTEVOMiArIFdPUkRfU0laRTIgKyBXT1JEX1NJWkUyO1xuICAgICAgY29uc3QgZW5jb2RlZEFyZ3NPZmZzZXQgPSBlbmNvZGVkU2VsZWN0b3JPZmZzZXQgKyBjYWxsMi5mblNlbGVjdG9yQnl0ZXMuYnl0ZUxlbmd0aDtcbiAgICAgIGNvbnN0IGVuY29kZWRBcmdzID0gYXJyYXlpZnkyKGNhbGwyLmRhdGEpO1xuICAgICAgbGV0IGdhc0ZvcndhcmRlZE9mZnNldCA9IDA7XG4gICAgICBzY3JpcHREYXRhLnB1c2gobmV3IEJpZ051bWJlckNvZGVyKFwidTY0XCIpLmVuY29kZShjYWxsMi5hbW91bnQgfHwgMCkpO1xuICAgICAgc2NyaXB0RGF0YS5wdXNoKG5ldyBCMjU2Q29kZXIoKS5lbmNvZGUoY2FsbDIuYXNzZXRJZD8udG9TdHJpbmcoKSB8fCBaZXJvQnl0ZXMzMikpO1xuICAgICAgc2NyaXB0RGF0YS5wdXNoKGNhbGwyLmNvbnRyYWN0SWQudG9CeXRlcygpKTtcbiAgICAgIHNjcmlwdERhdGEucHVzaChuZXcgQmlnTnVtYmVyQ29kZXIoXCJ1NjRcIikuZW5jb2RlKGVuY29kZWRTZWxlY3Rvck9mZnNldCkpO1xuICAgICAgc2NyaXB0RGF0YS5wdXNoKG5ldyBCaWdOdW1iZXJDb2RlcihcInU2NFwiKS5lbmNvZGUoZW5jb2RlZEFyZ3NPZmZzZXQpKTtcbiAgICAgIHNjcmlwdERhdGEucHVzaChjYWxsMi5mblNlbGVjdG9yQnl0ZXMpO1xuICAgICAgc2NyaXB0RGF0YS5wdXNoKGVuY29kZWRBcmdzKTtcbiAgICAgIGlmIChjYWxsMi5nYXMpIHtcbiAgICAgICAgc2NyaXB0RGF0YS5wdXNoKG5ldyBCaWdOdW1iZXJDb2RlcihcInU2NFwiKS5lbmNvZGUoY2FsbDIuZ2FzKSk7XG4gICAgICAgIGdhc0ZvcndhcmRlZE9mZnNldCA9IGVuY29kZWRBcmdzT2Zmc2V0ICsgZW5jb2RlZEFyZ3MuYnl0ZUxlbmd0aDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNhbGxQYXJhbU9mZnNldHMgPSB7XG4gICAgICAgIGFtb3VudE9mZnNldCxcbiAgICAgICAgYXNzZXRJZE9mZnNldCxcbiAgICAgICAgZ2FzRm9yd2FyZGVkT2Zmc2V0LFxuICAgICAgICBjYWxsRGF0YU9mZnNldFxuICAgICAgfTtcbiAgICAgIHBhcmFtT2Zmc2V0cy5wdXNoKGNhbGxQYXJhbU9mZnNldHMpO1xuICAgICAgc2VnbWVudE9mZnNldCA9IGRhdGFPZmZzZXQgKyBjb25jYXQyKHNjcmlwdERhdGEpLmJ5dGVMZW5ndGg7XG4gICAgfVxuICAgIGNvbnN0IHNjcmlwdCA9IGdldEluc3RydWN0aW9ucyhwYXJhbU9mZnNldHMpO1xuICAgIGNvbnN0IGZpbmFsU2NyaXB0RGF0YSA9IGNvbmNhdDIoc2NyaXB0RGF0YSk7XG4gICAgcmV0dXJuIHsgZGF0YTogZmluYWxTY3JpcHREYXRhLCBzY3JpcHQgfTtcbiAgfSxcbiAgKCkgPT4gW25ldyBVaW50OEFycmF5KCldXG4pLCBcImdldENvbnRyYWN0Q2FsbFNjcmlwdFwiKTtcblxuLy8gc3JjL3Jlc3BvbnNlLnRzXG5pbXBvcnQgeyBnZXRHYXNVc2VkRnJvbVJlY2VpcHRzIH0gZnJvbSBcIkBmdWVsLXRzL2FjY291bnRcIjtcbnZhciBleHRyYWN0SW52b2NhdGlvblJlc3VsdCA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKGZ1bmN0aW9uU2NvcGVzLCByZWNlaXB0cywgaXNNdWx0aUNhbGwsIGxvZ3MsIGdyb3VwZWRMb2dzID0ge30pID0+IHtcbiAgY29uc3QgbWFpbkNhbGxDb25maWcgPSBmdW5jdGlvblNjb3Blc1swXT8uZ2V0Q2FsbENvbmZpZygpO1xuICBpZiAoZnVuY3Rpb25TY29wZXMubGVuZ3RoID09PSAxICYmIG1haW5DYWxsQ29uZmlnICYmIFwiYnl0ZXNcIiBpbiBtYWluQ2FsbENvbmZpZy5wcm9ncmFtKSB7XG4gICAgcmV0dXJuIGNhbGxSZXN1bHRUb0ludm9jYXRpb25SZXN1bHQoeyByZWNlaXB0cyB9LCBtYWluQ2FsbENvbmZpZywgbG9ncywgZ3JvdXBlZExvZ3MpO1xuICB9XG4gIGNvbnN0IGVuY29kZWRSZXN1bHRzID0gZGVjb2RlQ29udHJhY3RDYWxsU2NyaXB0UmVzdWx0KFxuICAgIHsgcmVjZWlwdHMgfSxcbiAgICAobWFpbkNhbGxDb25maWc/LnByb2dyYW0pLmlkLFxuICAgIGxvZ3MsXG4gICAgZ3JvdXBlZExvZ3NcbiAgKTtcbiAgY29uc3QgZGVjb2RlZFJlc3VsdHMgPSBlbmNvZGVkUmVzdWx0cy5tYXAoKGVuY29kZWRSZXN1bHQsIGkpID0+IHtcbiAgICBjb25zdCB7IGZ1bmMgfSA9IGZ1bmN0aW9uU2NvcGVzW2ldLmdldENhbGxDb25maWcoKTtcbiAgICByZXR1cm4gZnVuYy5kZWNvZGVPdXRwdXQoZW5jb2RlZFJlc3VsdCk/LlswXTtcbiAgfSk7XG4gIHJldHVybiBpc011bHRpQ2FsbCA/IGRlY29kZWRSZXN1bHRzIDogZGVjb2RlZFJlc3VsdHM/LlswXTtcbn0sIFwiZXh0cmFjdEludm9jYXRpb25SZXN1bHRcIik7XG52YXIgYnVpbGRGdW5jdGlvblJlc3VsdCA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoYXN5bmMgKHBhcmFtcykgPT4ge1xuICBjb25zdCB7IGZ1bmNTY29wZSwgaXNNdWx0aUNhbGwsIHByb2dyYW0sIHRyYW5zYWN0aW9uUmVzcG9uc2UgfSA9IHBhcmFtcztcbiAgY29uc3QgdHhSZXN1bHQgPSBhd2FpdCB0cmFuc2FjdGlvblJlc3BvbnNlLndhaXRGb3JSZXN1bHQoKTtcbiAgY29uc3QgeyByZWNlaXB0cyB9ID0gdHhSZXN1bHQ7XG4gIGNvbnN0IGZ1bmN0aW9uU2NvcGVzID0gQXJyYXkuaXNBcnJheShmdW5jU2NvcGUpID8gZnVuY1Njb3BlIDogW2Z1bmNTY29wZV07XG4gIGNvbnN0IG1haW5DYWxsQ29uZmlnID0gZnVuY3Rpb25TY29wZXNbMF0/LmdldENhbGxDb25maWcoKTtcbiAgY29uc3QgeyBsb2dzLCBncm91cGVkTG9ncyB9ID0gZ2V0QWxsUmVzdWx0TG9ncyh7IHJlY2VpcHRzLCBtYWluQ2FsbENvbmZpZywgZnVuY3Rpb25TY29wZXMgfSk7XG4gIGNvbnN0IHZhbHVlID0gZXh0cmFjdEludm9jYXRpb25SZXN1bHQoXG4gICAgZnVuY3Rpb25TY29wZXMsXG4gICAgcmVjZWlwdHMsXG4gICAgaXNNdWx0aUNhbGwsXG4gICAgbG9ncyxcbiAgICBncm91cGVkTG9nc1xuICApO1xuICBjb25zdCBnYXNVc2VkID0gZ2V0R2FzVXNlZEZyb21SZWNlaXB0cyhyZWNlaXB0cyk7XG4gIGNvbnN0IHN1Ym1pdFJlc3VsdCA9IHtcbiAgICBpc011bHRpQ2FsbCxcbiAgICBmdW5jdGlvblNjb3BlcyxcbiAgICB2YWx1ZSxcbiAgICBwcm9ncmFtLFxuICAgIHRyYW5zYWN0aW9uUmVzdWx0OiB0eFJlc3VsdCxcbiAgICB0cmFuc2FjdGlvblJlc3BvbnNlLFxuICAgIHRyYW5zYWN0aW9uSWQ6IHRyYW5zYWN0aW9uUmVzcG9uc2UuaWQsXG4gICAgbG9ncyxcbiAgICBncm91cGVkTG9ncyxcbiAgICBnYXNVc2VkXG4gIH07XG4gIHJldHVybiBzdWJtaXRSZXN1bHQ7XG59LCBcImJ1aWxkRnVuY3Rpb25SZXN1bHRcIik7XG52YXIgYnVpbGRQcmVDb25maXJtYXRpb25GdW5jdGlvblJlc3VsdCA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoYXN5bmMgKHBhcmFtcykgPT4ge1xuICBjb25zdCB7IGZ1bmNTY29wZSwgaXNNdWx0aUNhbGwsIHByb2dyYW0sIHRyYW5zYWN0aW9uUmVzcG9uc2UgfSA9IHBhcmFtcztcbiAgY29uc3QgdHJhbnNhY3Rpb25SZXN1bHQgPSBhd2FpdCB0cmFuc2FjdGlvblJlc3BvbnNlLndhaXRGb3JQcmVDb25maXJtYXRpb24oKTtcbiAgY29uc3QgeyByZWNlaXB0cyB9ID0gdHJhbnNhY3Rpb25SZXN1bHQ7XG4gIGNvbnN0IGZ1bmN0aW9uU2NvcGVzID0gQXJyYXkuaXNBcnJheShmdW5jU2NvcGUpID8gZnVuY1Njb3BlIDogW2Z1bmNTY29wZV07XG4gIGNvbnN0IG1haW5DYWxsQ29uZmlnID0gZnVuY3Rpb25TY29wZXNbMF0/LmdldENhbGxDb25maWcoKTtcbiAgbGV0IGxvZ3M7XG4gIGxldCBncm91cGVkTG9ncztcbiAgbGV0IGdhc1VzZWQ7XG4gIGxldCB2YWx1ZTtcbiAgaWYgKHJlY2VpcHRzKSB7XG4gICAgKHsgbG9ncywgZ3JvdXBlZExvZ3MgfSA9IGdldEFsbFJlc3VsdExvZ3MoeyByZWNlaXB0cywgbWFpbkNhbGxDb25maWcsIGZ1bmN0aW9uU2NvcGVzIH0pKTtcbiAgICB2YWx1ZSA9IGV4dHJhY3RJbnZvY2F0aW9uUmVzdWx0KGZ1bmN0aW9uU2NvcGVzLCByZWNlaXB0cywgaXNNdWx0aUNhbGwsIGxvZ3MsIGdyb3VwZWRMb2dzKTtcbiAgICBnYXNVc2VkID0gZ2V0R2FzVXNlZEZyb21SZWNlaXB0cyhyZWNlaXB0cyk7XG4gIH1cbiAgY29uc3Qgc3VibWl0UmVzdWx0ID0ge1xuICAgIGlzTXVsdGlDYWxsLFxuICAgIGZ1bmN0aW9uU2NvcGVzLFxuICAgIHByb2dyYW0sXG4gICAgdHJhbnNhY3Rpb25SZXN1bHQsXG4gICAgdHJhbnNhY3Rpb25SZXNwb25zZSxcbiAgICB0cmFuc2FjdGlvbklkOiB0cmFuc2FjdGlvblJlc3BvbnNlLmlkLFxuICAgIGxvZ3MsXG4gICAgZ3JvdXBlZExvZ3MsXG4gICAgZ2FzVXNlZCxcbiAgICB2YWx1ZVxuICB9O1xuICByZXR1cm4gc3VibWl0UmVzdWx0O1xufSwgXCJidWlsZFByZUNvbmZpcm1hdGlvbkZ1bmN0aW9uUmVzdWx0XCIpO1xudmFyIGJ1aWxkRHJ5UnVuUmVzdWx0ID0gLyogQF9fUFVSRV9fICovIF9fbmFtZSgocGFyYW1zKSA9PiB7XG4gIGNvbnN0IHsgZnVuY1Njb3BlcywgY2FsbFJlc3VsdCwgaXNNdWx0aUNhbGwgfSA9IHBhcmFtcztcbiAgY29uc3QgeyByZWNlaXB0cyB9ID0gY2FsbFJlc3VsdDtcbiAgY29uc3QgZnVuY3Rpb25TY29wZXMgPSBBcnJheS5pc0FycmF5KGZ1bmNTY29wZXMpID8gZnVuY1Njb3BlcyA6IFtmdW5jU2NvcGVzXTtcbiAgY29uc3QgbWFpbkNhbGxDb25maWcgPSBmdW5jdGlvblNjb3Blc1swXT8uZ2V0Q2FsbENvbmZpZygpO1xuICBjb25zdCB7IGxvZ3MsIGdyb3VwZWRMb2dzIH0gPSBnZXRBbGxSZXN1bHRMb2dzKHsgcmVjZWlwdHMsIG1haW5DYWxsQ29uZmlnLCBmdW5jdGlvblNjb3BlcyB9KTtcbiAgY29uc3QgdmFsdWUgPSBleHRyYWN0SW52b2NhdGlvblJlc3VsdChcbiAgICBmdW5jdGlvblNjb3BlcyxcbiAgICByZWNlaXB0cyxcbiAgICBpc011bHRpQ2FsbCxcbiAgICBsb2dzLFxuICAgIGdyb3VwZWRMb2dzXG4gICk7XG4gIGNvbnN0IGdhc1VzZWQgPSBnZXRHYXNVc2VkRnJvbVJlY2VpcHRzKHJlY2VpcHRzKTtcbiAgY29uc3Qgc3VibWl0UmVzdWx0ID0ge1xuICAgIGZ1bmN0aW9uU2NvcGVzLFxuICAgIGNhbGxSZXN1bHQsXG4gICAgaXNNdWx0aUNhbGwsXG4gICAgZ2FzVXNlZCxcbiAgICB2YWx1ZVxuICB9O1xuICByZXR1cm4gc3VibWl0UmVzdWx0O1xufSwgXCJidWlsZERyeVJ1blJlc3VsdFwiKTtcblxuLy8gc3JjL2Z1bmN0aW9ucy9iYXNlLWludm9jYXRpb24tc2NvcGUudHNcbmZ1bmN0aW9uIGNyZWF0ZUNvbnRyYWN0Q2FsbChmdW5jU2NvcGUpIHtcbiAgY29uc3QgeyBwcm9ncmFtLCBhcmdzLCBmb3J3YXJkLCBmdW5jLCBjYWxsUGFyYW1ldGVycywgZXh0ZXJuYWxBYmlzIH0gPSBmdW5jU2NvcGUuZ2V0Q2FsbENvbmZpZygpO1xuICBjb25zdCBkYXRhID0gZnVuYy5lbmNvZGVBcmd1bWVudHMoYXJncyk7XG4gIHJldHVybiB7XG4gICAgY29udHJhY3RJZDogcHJvZ3JhbS5pZCxcbiAgICBmblNlbGVjdG9yQnl0ZXM6IGZ1bmMuc2VsZWN0b3JCeXRlcyxcbiAgICBkYXRhLFxuICAgIGFzc2V0SWQ6IGZvcndhcmQ/LmFzc2V0SWQsXG4gICAgYW1vdW50OiBmb3J3YXJkPy5hbW91bnQsXG4gICAgZ2FzOiBjYWxsUGFyYW1ldGVycz8uZ2FzTGltaXQsXG4gICAgZXh0ZXJuYWxDb250cmFjdHNBYmlzOiBleHRlcm5hbEFiaXNcbiAgfTtcbn1cbl9fbmFtZShjcmVhdGVDb250cmFjdENhbGwsIFwiY3JlYXRlQ29udHJhY3RDYWxsXCIpO1xudmFyIEJhc2VJbnZvY2F0aW9uU2NvcGUgPSBjbGFzcyB7XG4gIHN0YXRpYyB7XG4gICAgX19uYW1lKHRoaXMsIFwiQmFzZUludm9jYXRpb25TY29wZVwiKTtcbiAgfVxuICB0cmFuc2FjdGlvblJlcXVlc3Q7XG4gIHByb2dyYW07XG4gIGZ1bmN0aW9uSW52b2NhdGlvblNjb3BlcyA9IFtdO1xuICB0eFBhcmFtZXRlcnM7XG4gIGFzc2VtYmxlVHhQYXJhbWV0ZXJzO1xuICByZXF1aXJlZENvaW5zID0gW107XG4gIGlzTXVsdGlDYWxsID0gZmFsc2U7XG4gIGhhc0NhbGxQYXJhbXNHYXNMaW1pdCA9IGZhbHNlO1xuICAvLyBmbGFnIHRvIGNoZWNrIGlmIGFueSBvZiB0aGUgY2FsbFBhcmFtcyBoYXMgZ2FzTGltaXQgc2V0XG4gIGV4dGVybmFsQWJpcyA9IHt9O1xuICAvKipcbiAgICogQGRlcHJlY2F0ZWQgLSBTaG91bGQgYmUgcmVtb3ZlZCB3aXRoIGBhZGRTaWduZXJzYFxuICAgKi9cbiAgYWRkU2lnbmVyc0NhbGxiYWNrO1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhbiBpbnN0YW5jZSBvZiBCYXNlSW52b2NhdGlvblNjb3BlLlxuICAgKlxuICAgKiBAcGFyYW0gcHJvZ3JhbSAtIFRoZSBhYnN0cmFjdCBwcm9ncmFtIHRvIGJlIGludm9rZWQuXG4gICAqIEBwYXJhbSBpc011bHRpQ2FsbCAtIEEgZmxhZyBpbmRpY2F0aW5nIHdoZXRoZXIgdGhlIGludm9jYXRpb24gaXMgYSBtdWx0aS1jYWxsLlxuICAgKi9cbiAgY29uc3RydWN0b3IocHJvZ3JhbSwgaXNNdWx0aUNhbGwpIHtcbiAgICB0aGlzLnByb2dyYW0gPSBwcm9ncmFtO1xuICAgIHRoaXMuaXNNdWx0aUNhbGwgPSBpc011bHRpQ2FsbDtcbiAgICB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdCA9IG5ldyBTY3JpcHRUcmFuc2FjdGlvblJlcXVlc3QoKTtcbiAgfVxuICAvKipcbiAgICogR2V0dGVyIGZvciB0aGUgY29udHJhY3QgY2FsbHMuXG4gICAqXG4gICAqIEByZXR1cm5zIEFuIGFycmF5IG9mIGNvbnRyYWN0IGNhbGxzLlxuICAgKi9cbiAgZ2V0IGNhbGxzKCkge1xuICAgIHJldHVybiB0aGlzLmZ1bmN0aW9uSW52b2NhdGlvblNjb3Blcy5tYXAoKGZ1bmNTY29wZSkgPT4gY3JlYXRlQ29udHJhY3RDYWxsKGZ1bmNTY29wZSkpO1xuICB9XG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBzY3JpcHQgcmVxdWVzdCB3aXRoIHRoZSBjdXJyZW50IGNvbnRyYWN0IGNhbGxzLlxuICAgKi9cbiAgYXN5bmMgdXBkYXRlU2NyaXB0UmVxdWVzdCgpIHtcbiAgICBjb25zdCBwcm92aWRlciA9IHRoaXMuZ2V0UHJvdmlkZXIoKTtcbiAgICBjb25zdCB7XG4gICAgICBjb25zZW5zdXNQYXJhbWV0ZXJzOiB7XG4gICAgICAgIHR4UGFyYW1ldGVyczogeyBtYXhJbnB1dHMgfVxuICAgICAgfVxuICAgIH0gPSBhd2FpdCBwcm92aWRlci5nZXRDaGFpbigpO1xuICAgIGNvbnN0IGNvbnRyYWN0Q2FsbFNjcmlwdCA9IGdldENvbnRyYWN0Q2FsbFNjcmlwdCh0aGlzLmZ1bmN0aW9uSW52b2NhdGlvblNjb3BlcywgbWF4SW5wdXRzKTtcbiAgICB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdC5zZXRTY3JpcHQoY29udHJhY3RDYWxsU2NyaXB0LCB0aGlzLmNhbGxzKTtcbiAgfVxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgdHJhbnNhY3Rpb24gcmVxdWVzdCB3aXRoIHRoZSBjdXJyZW50IGlucHV0L291dHB1dC5cbiAgICovXG4gIHVwZGF0ZUNvbnRyYWN0SW5wdXRBbmRPdXRwdXQoKSB7XG4gICAgY29uc3QgY2FsbHMgPSB0aGlzLmNhbGxzO1xuICAgIGNhbGxzLmZvckVhY2goKGMpID0+IHtcbiAgICAgIGlmIChjLmNvbnRyYWN0SWQpIHtcbiAgICAgICAgdGhpcy50cmFuc2FjdGlvblJlcXVlc3QuYWRkQ29udHJhY3RJbnB1dEFuZE91dHB1dChjLmNvbnRyYWN0SWQpO1xuICAgICAgfVxuICAgICAgaWYgKGMuZXh0ZXJuYWxDb250cmFjdHNBYmlzKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKGMuZXh0ZXJuYWxDb250cmFjdHNBYmlzKS5mb3JFYWNoKFxuICAgICAgICAgIChjb250cmFjdElkKSA9PiB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdC5hZGRDb250cmFjdElucHV0QW5kT3V0cHV0KG5ldyBBZGRyZXNzKGNvbnRyYWN0SWQpKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIHRoZSByZXF1aXJlZCBjb2lucyBmb3IgdGhlIHRyYW5zYWN0aW9uLlxuICAgKlxuICAgKiBAcmV0dXJucyBBbiBhcnJheSBvZiByZXF1aXJlZCBjb2luIHF1YW50aXRpZXMuXG4gICAqL1xuICBnZXRSZXF1aXJlZENvaW5zKCkge1xuICAgIGNvbnN0IGZvcndhcmRpbmdBc3NldHMgPSB0aGlzLmNhbGxzLm1hcCgoY2FsbDIpID0+ICh7XG4gICAgICBhc3NldElkOiBTdHJpbmcoY2FsbDIuYXNzZXRJZCksXG4gICAgICBhbW91bnQ6IGJuMihjYWxsMi5hbW91bnQgfHwgMClcbiAgICB9KSkuZmlsdGVyKCh7IGFzc2V0SWQsIGFtb3VudCB9KSA9PiBhc3NldElkICYmICFibjIoYW1vdW50KS5pc1plcm8oKSk7XG4gICAgcmV0dXJuIGZvcndhcmRpbmdBc3NldHM7XG4gIH1cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHJlcXVpcmVkIGNvaW5zIGZvciB0aGUgdHJhbnNhY3Rpb24uXG4gICAqL1xuICB1cGRhdGVSZXF1aXJlZENvaW5zKCkge1xuICAgIGNvbnN0IGFzc2V0cyA9IHRoaXMuZ2V0UmVxdWlyZWRDb2lucygpO1xuICAgIGNvbnN0IHJlZHVjZUZvcndhcmRDb2lucyA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKHJlcXVpcmVkQ29pbnMsIHsgYXNzZXRJZCwgYW1vdW50IH0pID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRBbW91bnQgPSByZXF1aXJlZENvaW5zLmdldChhc3NldElkKT8uYW1vdW50IHx8IGJuMigwKTtcbiAgICAgIHJldHVybiByZXF1aXJlZENvaW5zLnNldChhc3NldElkLCB7XG4gICAgICAgIGFzc2V0SWQ6IFN0cmluZyhhc3NldElkKSxcbiAgICAgICAgYW1vdW50OiBjdXJyZW50QW1vdW50LmFkZChhbW91bnQpXG4gICAgICB9KTtcbiAgICB9LCBcInJlZHVjZUZvcndhcmRDb2luc1wiKTtcbiAgICB0aGlzLnJlcXVpcmVkQ29pbnMgPSBBcnJheS5mcm9tKFxuICAgICAgYXNzZXRzLnJlZHVjZShyZWR1Y2VGb3J3YXJkQ29pbnMsIC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCkpLnZhbHVlcygpXG4gICAgKTtcbiAgfVxuICAvKipcbiAgICogQWRkcyBhIHNpbmdsZSBjYWxsIHRvIHRoZSBpbnZvY2F0aW9uIHNjb3BlLlxuICAgKlxuICAgKiBAcGFyYW0gZnVuY1Njb3BlIC0gVGhlIGZ1bmN0aW9uIHNjb3BlIHRvIGFkZC5cbiAgICogQHJldHVybnMgVGhlIGN1cnJlbnQgaW5zdGFuY2Ugb2YgdGhlIGNsYXNzLlxuICAgKi9cbiAgYWRkQ2FsbChmdW5jU2NvcGUpIHtcbiAgICB0aGlzLmFkZENhbGxzKFtmdW5jU2NvcGVdKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgICogQWRkcyBtdWx0aXBsZSBjYWxscyB0byB0aGUgaW52b2NhdGlvbiBzY29wZS5cbiAgICpcbiAgICogQHBhcmFtIGZ1bmNTY29wZXMgLSBBbiBhcnJheSBvZiBmdW5jdGlvbiBzY29wZXMgdG8gYWRkLlxuICAgKiBAcmV0dXJucyBUaGUgY3VycmVudCBpbnN0YW5jZSBvZiB0aGUgY2xhc3MuXG4gICAqL1xuICBhZGRDYWxscyhmdW5jU2NvcGVzKSB7XG4gICAgdGhpcy5mdW5jdGlvbkludm9jYXRpb25TY29wZXMucHVzaCguLi5mdW5jU2NvcGVzKTtcbiAgICB0aGlzLnVwZGF0ZUNvbnRyYWN0SW5wdXRBbmRPdXRwdXQoKTtcbiAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkQ29pbnMoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgICogUHJlcGFyZXMgdGhlIHRyYW5zYWN0aW9uIGJ5IHVwZGF0aW5nIHRoZSBzY3JpcHQgcmVxdWVzdCwgcmVxdWlyZWQgY29pbnMsIGFuZCBjaGVja2luZyB0aGUgZ2FzIGxpbWl0LlxuICAgKi9cbiAgYXN5bmMgcHJlcGFyZVRyYW5zYWN0aW9uKCkge1xuICAgIGF3YWl0IGFzbTIuaW5pdFdhc20oKTtcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZVNjcmlwdFJlcXVlc3QoKTtcbiAgICB0aGlzLnVwZGF0ZVJlcXVpcmVkQ29pbnMoKTtcbiAgICB0aGlzLmNoZWNrR2FzTGltaXRUb3RhbCgpO1xuICAgIGlmICh0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdC50eXBlID09PSBUcmFuc2FjdGlvblR5cGUuU2NyaXB0KSB7XG4gICAgICB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdC5hYmlzID0gZ2V0QWJpc0Zyb21BbGxDYWxscyh0aGlzLmZ1bmN0aW9uSW52b2NhdGlvblNjb3Blcyk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIHRvdGFsIGdhcyBsaW1pdCBpcyB3aXRoaW4gdGhlIGFjY2VwdGFibGUgcmFuZ2UuXG4gICAqL1xuICBjaGVja0dhc0xpbWl0VG90YWwoKSB7XG4gICAgY29uc3QgZ2FzTGltaXRPbkNhbGxzID0gdGhpcy5jYWxscy5yZWR1Y2UoKHRvdGFsLCBjYWxsMikgPT4gdG90YWwuYWRkKGNhbGwyLmdhcyB8fCAwKSwgYm4yKDApKTtcbiAgICBpZiAodGhpcy50cmFuc2FjdGlvblJlcXVlc3QuZ2FzTGltaXQuZXEoMCkpIHtcbiAgICAgIHRoaXMudHJhbnNhY3Rpb25SZXF1ZXN0Lmdhc0xpbWl0ID0gZ2FzTGltaXRPbkNhbGxzO1xuICAgIH0gZWxzZSBpZiAoZ2FzTGltaXRPbkNhbGxzLmd0KHRoaXMudHJhbnNhY3Rpb25SZXF1ZXN0Lmdhc0xpbWl0KSkge1xuICAgICAgdGhyb3cgbmV3IEZ1ZWxFcnJvcjQoXG4gICAgICAgIEVycm9yQ29kZTQuVFJBTlNBQ1RJT05fRVJST1IsXG4gICAgICAgIFwiVHJhbnNhY3Rpb24ncyBnYXNMaW1pdCBtdXN0IGJlIGVxdWFsIHRvIG9yIGdyZWF0ZXIgdGhhbiB0aGUgY29tYmluZWQgZm9yd2FyZGVkIGdhcyBvZiBhbGwgY2FsbHMuXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBHZXRzIHRoZSB0cmFuc2FjdGlvbiBjb3N0IGZvciBkcnkgcnVubmluZyB0aGUgdHJhbnNhY3Rpb24uXG4gICAqXG4gICAqIEByZXR1cm5zIFRoZSB0cmFuc2FjdGlvbiBjb3N0IGRldGFpbHMuXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIFVzZSBjb250cmFjdC5mdW5kV2l0aFJlcXVpcmVkQ29pbnMgaW5zdGVhZFxuICAgKiBDaGVjayB0aGUgbWlncmF0aW9uIGd1aWRlIGh0dHBzOi8vZG9jcy5mdWVsLm5ldHdvcmsvZG9jcy9mdWVscy10cy90cmFuc2FjdGlvbnMvYXNzZW1ibGUtdHgtbWlncmF0aW9uLWd1aWRlLyBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICovXG4gIGFzeW5jIGdldFRyYW5zYWN0aW9uQ29zdCgpIHtcbiAgICBjb25zdCByZXF1ZXN0ID0gY2xvbmUoYXdhaXQgdGhpcy5nZXRUcmFuc2FjdGlvblJlcXVlc3QoKSk7XG4gICAgY29uc3QgYWNjb3VudCA9IHRoaXMucHJvZ3JhbS5hY2NvdW50ID8/IFdhbGxldC5nZW5lcmF0ZSh7IHByb3ZpZGVyOiB0aGlzLmdldFByb3ZpZGVyKCkgfSk7XG4gICAgcmV0dXJuIGFjY291bnQuZ2V0VHJhbnNhY3Rpb25Db3N0KHJlcXVlc3QsIHtcbiAgICAgIHF1YW50aXRpZXM6IHRoaXMuZ2V0UmVxdWlyZWRDb2lucygpLFxuICAgICAgc2lnbmF0dXJlQ2FsbGJhY2s6IHRoaXMuYWRkU2lnbmVyc0NhbGxiYWNrXG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEZ1bmRzIHRoZSB0cmFuc2FjdGlvbiByZXF1ZXN0IHdpdGggdGhlIHJlcXVpcmVkIGNvaW5zIGFuZCByZXR1cm5zIGl0LlxuICAgKlxuICAgKiBAcmV0dXJucyBUaGUgdHJhbnNhY3Rpb24gcmVxdWVzdC5cbiAgICovXG4gIGFzeW5jIGZ1bmRXaXRoUmVxdWlyZWRDb2lucygpIHtcbiAgICBsZXQgcmVxdWVzdCA9IGF3YWl0IHRoaXMuZ2V0VHJhbnNhY3Rpb25SZXF1ZXN0KCk7XG4gICAgcmVxdWVzdCA9IGNsb25lKHJlcXVlc3QpO1xuICAgIGxldCB7IGZlZVBheWVyQWNjb3VudCwgYWNjb3VudENvaW5RdWFudGl0aWVzLCAuLi5yZXN0QXNzZW1ibGVUeFBhcmFtcyB9ID0gdGhpcy5hc3NlbWJsZVR4UGFyYW1ldGVycyA/PyB7fTtcbiAgICByZXF1ZXN0Lm1heEZlZSA9IGJuMigwKTtcbiAgICByZXF1ZXN0Lmdhc0xpbWl0ID0gYm4yKDApO1xuICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcigpO1xuICAgIGNvbnN0IGFjY291bnQgPSB0aGlzLnByb2dyYW0uYWNjb3VudCA/PyBXYWxsZXQuZ2VuZXJhdGUoeyBwcm92aWRlciB9KTtcbiAgICBjb25zdCBiYXNlQXNzZXRJZCA9IGF3YWl0IHByb3ZpZGVyLmdldEJhc2VBc3NldElkKCk7XG4gICAgaWYgKCFmZWVQYXllckFjY291bnQpIHtcbiAgICAgIGZlZVBheWVyQWNjb3VudCA9IGFjY291bnQ7XG4gICAgfVxuICAgIGlmICghYWNjb3VudENvaW5RdWFudGl0aWVzKSB7XG4gICAgICBjb25zdCBvdXRwdXRRdWFudGl0aWVzID0gcmVxdWVzdC5vdXRwdXRzLmZpbHRlcigobykgPT4gby50eXBlID09PSBPdXRwdXRUeXBlLkNvaW4pLm1hcCgoeyBhbW91bnQsIGFzc2V0SWQgfSkgPT4gKHsgYXNzZXRJZDogU3RyaW5nKGFzc2V0SWQpLCBhbW91bnQ6IGJuMihhbW91bnQpIH0pKTtcbiAgICAgIGFjY291bnRDb2luUXVhbnRpdGllcyA9IG1lcmdlUXVhbnRpdGllcyhvdXRwdXRRdWFudGl0aWVzLCB0aGlzLnJlcXVpcmVkQ29pbnMpO1xuICAgICAgaWYgKCFhY2NvdW50Q29pblF1YW50aXRpZXMubGVuZ3RoKSB7XG4gICAgICAgIGFjY291bnRDb2luUXVhbnRpdGllcy5wdXNoKHsgYXNzZXRJZDogYmFzZUFzc2V0SWQsIGFtb3VudDogYm4yKDApIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBsZXQgeyBhc3NlbWJsZWRSZXF1ZXN0LCBnYXNQcmljZSB9ID0gYXdhaXQgcHJvdmlkZXIuYXNzZW1ibGVUeCh7XG4gICAgICByZXF1ZXN0LFxuICAgICAgZmVlUGF5ZXJBY2NvdW50LFxuICAgICAgYWNjb3VudENvaW5RdWFudGl0aWVzLFxuICAgICAgLi4ucmVzdEFzc2VtYmxlVHhQYXJhbXNcbiAgICB9KTtcbiAgICBhc3NlbWJsZWRSZXF1ZXN0ID0gYXNzZW1ibGVkUmVxdWVzdDtcbiAgICBhd2FpdCBzZXRBbmRWYWxpZGF0ZUdhc0FuZEZlZUZvckFzc2VtYmxlZFR4KHtcbiAgICAgIGdhc1ByaWNlLFxuICAgICAgcHJvdmlkZXIsXG4gICAgICB0cmFuc2FjdGlvblJlcXVlc3Q6IGFzc2VtYmxlZFJlcXVlc3QsXG4gICAgICBzZXRHYXNMaW1pdDogdGhpcy50eFBhcmFtZXRlcnM/Lmdhc0xpbWl0LFxuICAgICAgc2V0TWF4RmVlOiB0aGlzLnR4UGFyYW1ldGVycz8ubWF4RmVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGFzc2VtYmxlZFJlcXVlc3Q7XG4gIH1cbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIC0gU2hvdWxkIGJlIHJlbW92ZWQgd2l0aCBgYWRkU2lnbmVyc2BcbiAgICovXG4gIGFzeW5jIGxlZ2FjeUZ1bmRXaXRoUmVxdWlyZWRDb2lucygpIHtcbiAgICBsZXQgdHJhbnNhY3Rpb25SZXF1ZXN0ID0gYXdhaXQgdGhpcy5nZXRUcmFuc2FjdGlvblJlcXVlc3QoKTtcbiAgICB0cmFuc2FjdGlvblJlcXVlc3QgPSBjbG9uZSh0cmFuc2FjdGlvblJlcXVlc3QpO1xuICAgIGNvbnN0IHR4Q29zdCA9IGF3YWl0IHRoaXMuZ2V0VHJhbnNhY3Rpb25Db3N0KCk7XG4gICAgY29uc3QgeyBnYXNVc2VkLCBtaXNzaW5nQ29udHJhY3RJZHMsIG91dHB1dFZhcmlhYmxlcywgbWF4RmVlIH0gPSB0eENvc3Q7XG4gICAgdGhpcy5zZXREZWZhdWx0VHhQYXJhbXModHJhbnNhY3Rpb25SZXF1ZXN0LCBnYXNVc2VkLCBtYXhGZWUpO1xuICAgIG1pc3NpbmdDb250cmFjdElkcy5mb3JFYWNoKChjb250cmFjdElkKSA9PiB7XG4gICAgICB0cmFuc2FjdGlvblJlcXVlc3QuYWRkQ29udHJhY3RJbnB1dEFuZE91dHB1dChuZXcgQWRkcmVzcyhjb250cmFjdElkKSk7XG4gICAgfSk7XG4gICAgdHJhbnNhY3Rpb25SZXF1ZXN0LmFkZFZhcmlhYmxlT3V0cHV0cyhvdXRwdXRWYXJpYWJsZXMpO1xuICAgIGF3YWl0IHRoaXMucHJvZ3JhbS5hY2NvdW50Py5mdW5kKHRyYW5zYWN0aW9uUmVxdWVzdCwgdHhDb3N0KTtcbiAgICBpZiAodGhpcy5hZGRTaWduZXJzQ2FsbGJhY2spIHtcbiAgICAgIGF3YWl0IHRoaXMuYWRkU2lnbmVyc0NhbGxiYWNrKHRyYW5zYWN0aW9uUmVxdWVzdCk7XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2FjdGlvblJlcXVlc3Q7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIHRyYW5zYWN0aW9uIHBhcmFtZXRlcnMuXG4gICAqXG4gICAqIEBwYXJhbSB0eFBhcmFtcyAtIFRoZSB0cmFuc2FjdGlvbiBwYXJhbWV0ZXJzIHRvIHNldC5cbiAgICogQHJldHVybnMgVGhlIGN1cnJlbnQgaW5zdGFuY2Ugb2YgdGhlIGNsYXNzLlxuICAgKi9cbiAgdHhQYXJhbXModHhQYXJhbXMpIHtcbiAgICB0aGlzLnR4UGFyYW1ldGVycyA9IHR4UGFyYW1zO1xuICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdDtcbiAgICByZXF1ZXN0LnRpcCA9IGJuMih0eFBhcmFtcy50aXAgfHwgcmVxdWVzdC50aXApO1xuICAgIHJlcXVlc3QuZ2FzTGltaXQgPSBibjIodHhQYXJhbXMuZ2FzTGltaXQgfHwgcmVxdWVzdC5nYXNMaW1pdCk7XG4gICAgcmVxdWVzdC5tYXhGZWUgPSB0eFBhcmFtcy5tYXhGZWUgPyBibjIodHhQYXJhbXMubWF4RmVlKSA6IHJlcXVlc3QubWF4RmVlO1xuICAgIHJlcXVlc3Qud2l0bmVzc0xpbWl0ID0gdHhQYXJhbXMud2l0bmVzc0xpbWl0ID8gYm4yKHR4UGFyYW1zLndpdG5lc3NMaW1pdCkgOiByZXF1ZXN0LndpdG5lc3NMaW1pdDtcbiAgICByZXF1ZXN0Lm1hdHVyaXR5ID0gdHhQYXJhbXMubWF0dXJpdHkgfHwgcmVxdWVzdC5tYXR1cml0eTtcbiAgICByZXF1ZXN0LmV4cGlyYXRpb24gPSB0eFBhcmFtcy5leHBpcmF0aW9uIHx8IHJlcXVlc3QuZXhwaXJhdGlvbjtcbiAgICByZXF1ZXN0LmFkZFZhcmlhYmxlT3V0cHV0cyh0aGlzLnR4UGFyYW1ldGVycz8udmFyaWFibGVPdXRwdXRzIHx8IDApO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIC8qKlxuICAgKiBTZXRzIHRoZSB0cmFuc2FjdGlvbiBwYXJhbWV0ZXJzLlxuICAgKlxuICAgKiBAcGFyYW0gYXNzZW1ibGVUeFBhcmFtcyAtIFRoZSBhc3NlbWJsZVR4IHBhcmFtZXRlcnMgdG8gc2V0IHdoZW4gaW52b2tpbmcgdGhlIGBwcm92aWRlci5hc3NlbWJsZVR4YCBtZXRob2QuXG4gICAqIEByZXR1cm5zIFRoZSBjdXJyZW50IGluc3RhbmNlIG9mIHRoZSBjbGFzcy5cbiAgICovXG4gIGFzc2VtYmxlVHhQYXJhbXModHhQYXJhbXMpIHtcbiAgICB0aGlzLmFzc2VtYmxlVHhQYXJhbWV0ZXJzID0gdHhQYXJhbXM7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgLyoqXG4gICAqIEFkZHMgY29udHJhY3RzIHRvIHRoZSBpbnZvY2F0aW9uIHNjb3BlLlxuICAgKlxuICAgKiBAcGFyYW0gY29udHJhY3RzIC0gQW4gYXJyYXkgb2YgY29udHJhY3RzIHRvIGFkZC5cbiAgICogQHJldHVybnMgVGhlIGN1cnJlbnQgaW5zdGFuY2Ugb2YgdGhlIGNsYXNzLlxuICAgKi9cbiAgYWRkQ29udHJhY3RzKGNvbnRyYWN0cykge1xuICAgIGNvbnRyYWN0cy5mb3JFYWNoKChjb250cmFjdCkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiBjb250cmFjdCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdC5hZGRDb250cmFjdElucHV0QW5kT3V0cHV0KG5ldyBBZGRyZXNzKGNvbnRyYWN0KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdC5hZGRDb250cmFjdElucHV0QW5kT3V0cHV0KGNvbnRyYWN0LmlkKTtcbiAgICAgICAgdGhpcy5leHRlcm5hbEFiaXNbY29udHJhY3QuaWQudG9CMjU2KCldID0gY29udHJhY3QuaW50ZXJmYWNlLmpzb25BYmk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgLyoqXG4gICAqIEFkZHMgYW4gYXNzZXQgdHJhbnNmZXIgdG8gYW4gQWNjb3VudCBvbiB0aGUgY29udHJhY3QgY2FsbCB0cmFuc2FjdGlvbiByZXF1ZXN0LlxuICAgKlxuICAgKiBAcGFyYW0gdHJhbnNmZXJQYXJhbXMgLSBUaGUgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgdHJhbnNmZXIgdG8gYmUgbWFkZS5cbiAgICogQHJldHVybnMgVGhlIGN1cnJlbnQgaW5zdGFuY2Ugb2YgdGhlIGNsYXNzLlxuICAgKi9cbiAgYWRkVHJhbnNmZXIodHJhbnNmZXJQYXJhbXMpIHtcbiAgICBjb25zdCB7IGFtb3VudCwgZGVzdGluYXRpb24sIGFzc2V0SWQgfSA9IHRyYW5zZmVyUGFyYW1zO1xuICAgIHRoaXMudHJhbnNhY3Rpb25SZXF1ZXN0ID0gdGhpcy50cmFuc2FjdGlvblJlcXVlc3QuYWRkQ29pbk91dHB1dChcbiAgICAgIG5ldyBBZGRyZXNzKGRlc3RpbmF0aW9uKSxcbiAgICAgIGFtb3VudCxcbiAgICAgIGFzc2V0SWRcbiAgICApO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIC8qKlxuICAgKiBBZGRzIG11bHRpcGxlIHRyYW5zZmVycyB0byB0aGUgY29udHJhY3QgY2FsbCB0cmFuc2FjdGlvbiByZXF1ZXN0LlxuICAgKlxuICAgKiBAcGFyYW0gdHJhbnNmZXJQYXJhbXMgLSBBbiBhcnJheSBvZiBgVHJhbnNmZXJQYXJhbXNgIG9iamVjdHMgcmVwcmVzZW50aW5nIHRoZSB0cmFuc2ZlcnMgdG8gYmUgbWFkZS5cbiAgICogQHJldHVybnMgVGhlIGN1cnJlbnQgaW5zdGFuY2Ugb2YgdGhlIGNsYXNzLlxuICAgKi9cbiAgYWRkQmF0Y2hUcmFuc2Zlcih0cmFuc2ZlclBhcmFtcykge1xuICAgIHRyYW5zZmVyUGFyYW1zLmZvckVhY2goKHsgZGVzdGluYXRpb24sIGFtb3VudCwgYXNzZXRJZCB9KSA9PiB7XG4gICAgICB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdCA9IHRoaXMudHJhbnNhY3Rpb25SZXF1ZXN0LmFkZENvaW5PdXRwdXQoXG4gICAgICAgIG5ldyBBZGRyZXNzKGRlc3RpbmF0aW9uKSxcbiAgICAgICAgYW1vdW50LFxuICAgICAgICBhc3NldElkXG4gICAgICApO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIC8qKlxuICAgKiBBZGRzIHNpZ25lcnMgdG8gdGhlIHRyYW5zYWN0aW9uIHJlcXVlc3QuXG4gICAqXG4gICAqIEBwYXJhbSBzaWduZXJzIC0gVGhlIHNpZ25lcnMgdG8gYWRkLlxuICAgKiBAcmV0dXJucyBUaGUgY3VycmVudCBpbnN0YW5jZSBvZiB0aGUgY2xhc3MuXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIFRoaXMgbWV0aG9kIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSB2ZXJzaW9ucy5cbiAgICogQWxsIHNpZ25hdHVyZXMgc2hvdWxkIGJlIG1hbnVhbGx5IGFkZGVkIHRvIHRoZSB0cmFuc2FjdGlvbiByZXF1ZXN0IHdpdG5lc3Nlcy4gSWYgeW91clxuICAgKiBTd2F5IHByb2dyYW0gcmVsaWVzIG9uIGluLWNvZGUgc2lnbmF0dXJlIHZhbGlkYXRpb24sIHZpc2l0IHRoaXMgZ3VpZGU6XG4gICAqIGh0dHBzOi8vZG9jcy5mdWVsLm5ldHdvcmsvZG9jcy9mdWVscy10cy9jb29rYm9vay9zd2F5LXNjcmlwdC13aXRoLXNpZ25hdHVyZS12YWxpZGF0aW9uL1xuICAgKi9cbiAgYWRkU2lnbmVycyhzaWduZXJzKSB7XG4gICAgdGhpcy5hZGRTaWduZXJzQ2FsbGJhY2sgPSAodHJhbnNhY3Rpb25SZXF1ZXN0KSA9PiB0cmFuc2FjdGlvblJlcXVlc3QuYWRkQWNjb3VudFdpdG5lc3NlcyhzaWduZXJzKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgICogUHJlcGFyZXMgYW5kIHJldHVybnMgdGhlIHRyYW5zYWN0aW9uIHJlcXVlc3Qgb2JqZWN0LlxuICAgKlxuICAgKiBAcmV0dXJucyBUaGUgcHJlcGFyZWQgdHJhbnNhY3Rpb24gcmVxdWVzdC5cbiAgICovXG4gIGFzeW5jIGdldFRyYW5zYWN0aW9uUmVxdWVzdCgpIHtcbiAgICBhd2FpdCB0aGlzLnByZXBhcmVUcmFuc2FjdGlvbigpO1xuICAgIHJldHVybiB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdDtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgdHJhbnNhY3Rpb24gcmVxdWVzdC4gVXNlZnVsIHdoZW4geW91IGhhdmUgdXNlZCBgZ2V0VHJhbnNhY3Rpb25SZXF1ZXN0YCBvclxuICAgKiBgZnVuZFdpdGhSZXF1aXJlZENvaW5zYCBmcm9tIHRoZSBzY29wZSB0byBhcHBseSBjdXN0b21pemF0aW9ucyB0byB0aGUgdHJhbnNhY3Rpb24gcmVxdWVzdC5cbiAgICpcbiAgICogQHBhcmFtIHJlcXVlc3QgLSBUaGUgdHJhbnNhY3Rpb24gcmVxdWVzdCB0byBzZXQuXG4gICAqIEByZXR1cm5zIFRoZSBjdXJyZW50IGluc3RhbmNlIG9mIHRoZSBjbGFzcy5cbiAgICovXG4gIGZyb21SZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICB0aGlzLnRyYW5zYWN0aW9uUmVxdWVzdCA9IHJlcXVlc3Q7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgLyoqXG4gICAqIFN1Ym1pdHMgdGhlIGNvbnRyYWN0IGNhbGwgdHJhbnNhY3Rpb24gYW5kIHJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYW4gb2JqZWN0XG4gICAqIGNvbnRhaW5pbmcgdGhlIHRyYW5zYWN0aW9uIElEIGFuZCBhIGZ1bmN0aW9uIHRvIHdhaXQgZm9yIHRoZSByZXN1bHQuIFRoZSBwcm9taXNlIHdpbGwgcmVzb2x2ZVxuICAgKiBhcyBzb29uIGFzIHRoZSB0cmFuc2FjdGlvbiBpcyBzdWJtaXR0ZWQgdG8gdGhlIG5vZGUuXG4gICAqXG4gICAqIEBwYXJhbSBwYXJhbXMgLSBPcHRpb25hbCBwYXJhbWV0ZXJzIGZvciB0aGUgY2FsbC5cbiAgICogLSBgc2tpcEFzc2VtYmxlVHhgOiBBIGJvb2xlYW4gaW5kaWNhdGluZyB3aGV0aGVyIHRvIHNraXAgYXNzZW1ibGluZyB0aGUgdHJhbnNhY3Rpb24uIFRoaXMgaXMgdXNlZnVsXG4gICAqICAgd2hlbiBjdXN0b21pemF0aW9ucyB3ZXJlIG1hZGUgdG8gdGhlIHRyYW5zYWN0aW9uIHJlcXVlc3QgdXNpbmcgdGhlIGBhc3NlbWJsZVR4YCBtZXRob2QuXG4gICAqXG4gICAqIEByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIGFuIG9iamVjdCBjb250YWluaW5nOlxuICAgKiAtIGB0cmFuc2FjdGlvbklkYDogVGhlIElEIG9mIHRoZSBzdWJtaXR0ZWQgdHJhbnNhY3Rpb24uXG4gICAqIC0gYHdhaXRGb3JSZXN1bHRgOiBBIGZ1bmN0aW9uIHRoYXQgd2FpdHMgZm9yIHRoZSB0cmFuc2FjdGlvbiByZXN1bHQuXG4gICAqIC0gYHdhaXRGb3JQcmVDb25maXJtYXRpb25gOiBBIGZ1bmN0aW9uIHRoYXQgd2FpdHMgZm9yIHRoZSB0cmFuc2FjdGlvbiBwcmUtY29uZmlybWF0aW9uLlxuICAgKiBAdGVtcGxhdGUgVCAtIFRoZSB0eXBlIG9mIHRoZSByZXR1cm4gdmFsdWUuXG4gICAqL1xuICBhc3luYyBjYWxsKHBhcmFtcykge1xuICAgIGFzc2VydCh0aGlzLnByb2dyYW0uYWNjb3VudCwgXCJXYWxsZXQgaXMgcmVxdWlyZWQhXCIpO1xuICAgIGxldCB0cmFuc2FjdGlvblJlcXVlc3QgPSBhd2FpdCB0aGlzLmdldFRyYW5zYWN0aW9uUmVxdWVzdCgpO1xuICAgIGNvbnN0IHNraXBBc3NlbWJsZVR4ID0gcGFyYW1zPy5za2lwQXNzZW1ibGVUeDtcbiAgICBpZiAoIXNraXBBc3NlbWJsZVR4KSB7XG4gICAgICBpZiAodGhpcy5hZGRTaWduZXJzQ2FsbGJhY2spIHtcbiAgICAgICAgdHJhbnNhY3Rpb25SZXF1ZXN0ID0gYXdhaXQgdGhpcy5sZWdhY3lGdW5kV2l0aFJlcXVpcmVkQ29pbnMoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRyYW5zYWN0aW9uUmVxdWVzdCA9IGF3YWl0IHRoaXMuZnVuZFdpdGhSZXF1aXJlZENvaW5zKCk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5wcm9ncmFtLmFjY291bnQuc2VuZFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uUmVxdWVzdCwge1xuICAgICAgZXN0aW1hdGVUeERlcGVuZGVuY2llczogZmFsc2VcbiAgICB9KTtcbiAgICBjb25zdCB0cmFuc2FjdGlvbklkID0gcmVzcG9uc2UuaWQ7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRyYW5zYWN0aW9uSWQsXG4gICAgICB3YWl0Rm9yUmVzdWx0OiAvKiBAX19QVVJFX18gKi8gX19uYW1lKGFzeW5jICgpID0+IGJ1aWxkRnVuY3Rpb25SZXN1bHQoe1xuICAgICAgICBmdW5jU2NvcGU6IHRoaXMuZnVuY3Rpb25JbnZvY2F0aW9uU2NvcGVzLFxuICAgICAgICBpc011bHRpQ2FsbDogdGhpcy5pc011bHRpQ2FsbCxcbiAgICAgICAgcHJvZ3JhbTogdGhpcy5wcm9ncmFtLFxuICAgICAgICB0cmFuc2FjdGlvblJlc3BvbnNlOiByZXNwb25zZVxuICAgICAgfSksIFwid2FpdEZvclJlc3VsdFwiKSxcbiAgICAgIHdhaXRGb3JQcmVDb25maXJtYXRpb246IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoYXN5bmMgKCkgPT4gYnVpbGRQcmVDb25maXJtYXRpb25GdW5jdGlvblJlc3VsdCh7XG4gICAgICAgIGZ1bmNTY29wZTogdGhpcy5mdW5jdGlvbkludm9jYXRpb25TY29wZXMsXG4gICAgICAgIGlzTXVsdGlDYWxsOiB0aGlzLmlzTXVsdGlDYWxsLFxuICAgICAgICBwcm9ncmFtOiB0aGlzLnByb2dyYW0sXG4gICAgICAgIHRyYW5zYWN0aW9uUmVzcG9uc2U6IHJlc3BvbnNlXG4gICAgICB9KSwgXCJ3YWl0Rm9yUHJlQ29uZmlybWF0aW9uXCIpXG4gICAgfTtcbiAgfVxuICAvKipcbiAgICogU2ltdWxhdGVzIGEgdHJhbnNhY3Rpb24uXG4gICAqXG4gICAqIEByZXR1cm5zIFRoZSByZXN1bHQgb2YgdGhlIGludm9jYXRpb24gY2FsbC5cbiAgICovXG4gIGFzeW5jIHNpbXVsYXRlKCkge1xuICAgIGFzc2VydCh0aGlzLnByb2dyYW0uYWNjb3VudCwgXCJXYWxsZXQgaXMgcmVxdWlyZWQhXCIpO1xuICAgIGlmICghKFwicG9wdWxhdGVUcmFuc2FjdGlvbldpdG5lc3Nlc1NpZ25hdHVyZVwiIGluIHRoaXMucHJvZ3JhbS5hY2NvdW50KSkge1xuICAgICAgdGhyb3cgbmV3IEZ1ZWxFcnJvcjQoXG4gICAgICAgIEVycm9yQ29kZTQuQUJJX01BSU5fTUVUSE9EX01JU1NJTkcsXG4gICAgICAgIFwiQW4gdW5sb2NrZWQgd2FsbGV0IGlzIHJlcXVpcmVkIHRvIHNpbXVsYXRlIGEgY29udHJhY3QgY2FsbC5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgdHJhbnNhY3Rpb25SZXF1ZXN0ID0gYXdhaXQgdGhpcy5mdW5kV2l0aFJlcXVpcmVkQ29pbnMoKTtcbiAgICBjb25zdCBjYWxsUmVzdWx0ID0gYXdhaXQgdGhpcy5wcm9ncmFtLmFjY291bnQuc2ltdWxhdGVUcmFuc2FjdGlvbih0cmFuc2FjdGlvblJlcXVlc3QsIHtcbiAgICAgIGVzdGltYXRlVHhEZXBlbmRlbmNpZXM6IGZhbHNlXG4gICAgfSk7XG4gICAgcmV0dXJuIGJ1aWxkRHJ5UnVuUmVzdWx0KHtcbiAgICAgIGZ1bmNTY29wZXM6IHRoaXMuZnVuY3Rpb25JbnZvY2F0aW9uU2NvcGVzLFxuICAgICAgY2FsbFJlc3VsdCxcbiAgICAgIGlzTXVsdGlDYWxsOiB0aGlzLmlzTXVsdGlDYWxsXG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEV4ZWN1dGVzIGEgdHJhbnNhY3Rpb24gaW4gZHJ5IHJ1biBtb2RlLlxuICAgKlxuICAgKiBAcmV0dXJucyBUaGUgcmVzdWx0IG9mIHRoZSBpbnZvY2F0aW9uIGNhbGwuXG4gICAqXG4gICAqIEBkZXByZWNhdGVkIFVzZSAuZ2V0IGluc3RlYWRcbiAgICovXG4gIGFzeW5jIGRyeVJ1bigpIHtcbiAgICBjb25zdCB7IHJlY2VpcHRzIH0gPSBhd2FpdCB0aGlzLmdldFRyYW5zYWN0aW9uQ29zdCgpO1xuICAgIGNvbnN0IGNhbGxSZXN1bHQgPSB7XG4gICAgICByZWNlaXB0c1xuICAgIH07XG4gICAgcmV0dXJuIGJ1aWxkRHJ5UnVuUmVzdWx0KHtcbiAgICAgIGZ1bmNTY29wZXM6IHRoaXMuZnVuY3Rpb25JbnZvY2F0aW9uU2NvcGVzLFxuICAgICAgY2FsbFJlc3VsdCxcbiAgICAgIGlzTXVsdGlDYWxsOiB0aGlzLmlzTXVsdGlDYWxsXG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgZ2V0KCkge1xuICAgIGxldCByZXF1ZXN0ID0gYXdhaXQgdGhpcy5nZXRUcmFuc2FjdGlvblJlcXVlc3QoKTtcbiAgICByZXF1ZXN0ID0gY2xvbmUocmVxdWVzdCk7XG4gICAgcmVxdWVzdC5tYXhGZWUgPSBibjIoMCk7XG4gICAgcmVxdWVzdC5nYXNMaW1pdCA9IGJuMigwKTtcbiAgICByZXF1ZXN0LmlucHV0cyA9IHJlcXVlc3QuaW5wdXRzLmZpbHRlcigoaSkgPT4gaS50eXBlICE9PSBJbnB1dFR5cGUuQ29pbik7XG4gICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLmdldFByb3ZpZGVyKCk7XG4gICAgY29uc3QgYWNjb3VudCA9IHRoaXMucHJvZ3JhbS5hY2NvdW50ID8/IFdhbGxldC5nZW5lcmF0ZSh7IHByb3ZpZGVyIH0pO1xuICAgIGNvbnN0IGJhc2VBc3NldElkID0gYXdhaXQgcHJvdmlkZXIuZ2V0QmFzZUFzc2V0SWQoKTtcbiAgICBjb25zdCBhbGxRdWFudGl0aWVzID0gcmVxdWVzdC5vdXRwdXRzLmZpbHRlcigobykgPT4gby50eXBlID09PSBPdXRwdXRUeXBlLkNvaW4pLm1hcCgoeyBhbW91bnQsIGFzc2V0SWQgfSkgPT4gKHsgYXNzZXRJZDogU3RyaW5nKGFzc2V0SWQpLCBhbW91bnQ6IGJuMihhbW91bnQpIH0pKS5jb25jYXQodGhpcy5yZXF1aXJlZENvaW5zKTtcbiAgICBjb25zdCByZXNvdXJjZXMgPSBhY2NvdW50LmdlbmVyYXRlRmFrZVJlc291cmNlcyhhbGxRdWFudGl0aWVzKTtcbiAgICBjb25zdCB1dHhvRm9yQmFzZUFzc2V0SWQgPSByZXNvdXJjZXMuZmluZCgodXR4bykgPT4gdXR4by5hc3NldElkID09PSBiYXNlQXNzZXRJZCk7XG4gICAgY29uc3QgYW1vdW50Rm9yRmVlID0gYm4yKFwiMTAwMDAwMDAwMDAwMDAwMFwiKTtcbiAgICBpZiAoIXV0eG9Gb3JCYXNlQXNzZXRJZCkge1xuICAgICAgY29uc3QgW2Jhc2VBc3NldFJlc291cmNlXSA9IGFjY291bnQuZ2VuZXJhdGVGYWtlUmVzb3VyY2VzKFtcbiAgICAgICAgeyBhc3NldElkOiBiYXNlQXNzZXRJZCwgYW1vdW50OiBhbW91bnRGb3JGZWUgfVxuICAgICAgXSk7XG4gICAgICByZXNvdXJjZXMucHVzaChiYXNlQXNzZXRSZXNvdXJjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHV0eG9Gb3JCYXNlQXNzZXRJZC5hbW91bnQgPSB1dHhvRm9yQmFzZUFzc2V0SWQuYW1vdW50LmFkZChhbW91bnRGb3JGZWUpO1xuICAgIH1cbiAgICByZXF1ZXN0LmFkZFJlc291cmNlcyhyZXNvdXJjZXMpO1xuICAgIGNvbnN0IHsgcmVjZWlwdHMgfSA9IGF3YWl0IHByb3ZpZGVyLmFzc2VtYmxlVHgoe1xuICAgICAgcmVxdWVzdCxcbiAgICAgIGZlZVBheWVyQWNjb3VudDogYWNjb3VudFxuICAgIH0pO1xuICAgIHJldHVybiBidWlsZERyeVJ1blJlc3VsdCh7XG4gICAgICBmdW5jU2NvcGVzOiB0aGlzLmZ1bmN0aW9uSW52b2NhdGlvblNjb3BlcyxcbiAgICAgIGNhbGxSZXN1bHQ6IHsgcmVjZWlwdHMgfSxcbiAgICAgIGlzTXVsdGlDYWxsOiB0aGlzLmlzTXVsdGlDYWxsXG4gICAgfSk7XG4gIH1cbiAgZ2V0UHJvdmlkZXIoKSB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb2dyYW0ucHJvdmlkZXI7XG4gICAgcmV0dXJuIHByb3ZpZGVyO1xuICB9XG4gIC8qKlxuICAgKiBJbiBjYXNlIHRoZSBnYXNMaW1pdCBpcyAqbm90KiBzZXQgYnkgdGhlIHVzZXIsIHRoaXMgbWV0aG9kIHNldHMgYSBkZWZhdWx0IHZhbHVlLlxuICAgKi9cbiAgc2V0RGVmYXVsdFR4UGFyYW1zKHRyYW5zYWN0aW9uUmVxdWVzdCwgZ2FzVXNlZCwgbWF4RmVlKSB7XG4gICAgY29uc3QgZ2FzTGltaXRTcGVjaWZpZWQgPSBpc0RlZmluZWQodGhpcy50eFBhcmFtZXRlcnM/Lmdhc0xpbWl0KSB8fCB0aGlzLmhhc0NhbGxQYXJhbXNHYXNMaW1pdDtcbiAgICBjb25zdCBtYXhGZWVTcGVjaWZpZWQgPSBpc0RlZmluZWQodGhpcy50eFBhcmFtZXRlcnM/Lm1heEZlZSk7XG4gICAgY29uc3QgeyBnYXNMaW1pdDogc2V0R2FzTGltaXQsIG1heEZlZTogc2V0TWF4RmVlIH0gPSB0cmFuc2FjdGlvblJlcXVlc3Q7XG4gICAgaWYgKCFnYXNMaW1pdFNwZWNpZmllZCkge1xuICAgICAgdHJhbnNhY3Rpb25SZXF1ZXN0Lmdhc0xpbWl0ID0gZ2FzVXNlZDtcbiAgICB9IGVsc2UgaWYgKHNldEdhc0xpbWl0Lmx0KGdhc1VzZWQpKSB7XG4gICAgICB0aHJvdyBuZXcgRnVlbEVycm9yNChcbiAgICAgICAgRXJyb3JDb2RlNC5HQVNfTElNSVRfVE9PX0xPVyxcbiAgICAgICAgYEdhcyBsaW1pdCAnJHtzZXRHYXNMaW1pdH0nIGlzIGxvd2VyIHRoYW4gdGhlIHJlcXVpcmVkOiAnJHtnYXNVc2VkfScuYFxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKCFtYXhGZWVTcGVjaWZpZWQpIHtcbiAgICAgIHRyYW5zYWN0aW9uUmVxdWVzdC5tYXhGZWUgPSBtYXhGZWU7XG4gICAgfSBlbHNlIGlmIChtYXhGZWUuZ3Qoc2V0TWF4RmVlKSkge1xuICAgICAgdGhyb3cgbmV3IEZ1ZWxFcnJvcjQoXG4gICAgICAgIEVycm9yQ29kZTQuTUFYX0ZFRV9UT09fTE9XLFxuICAgICAgICBgTWF4IGZlZSAnJHtzZXRNYXhGZWV9JyBpcyBsb3dlciB0aGFuIHRoZSByZXF1aXJlZDogJyR7bWF4RmVlfScuYFxuICAgICAgKTtcbiAgICB9XG4gIH1cbn07XG5cbi8vIHNyYy9mdW5jdGlvbnMvaW52b2NhdGlvbi1zY29wZS50c1xudmFyIEZ1bmN0aW9uSW52b2NhdGlvblNjb3BlID0gY2xhc3MgZXh0ZW5kcyBCYXNlSW52b2NhdGlvblNjb3BlIHtcbiAgc3RhdGljIHtcbiAgICBfX25hbWUodGhpcywgXCJGdW5jdGlvbkludm9jYXRpb25TY29wZVwiKTtcbiAgfVxuICBmdW5jO1xuICBjYWxsUGFyYW1ldGVycztcbiAgZm9yd2FyZDtcbiAgYXJncztcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYW4gaW5zdGFuY2Ugb2YgRnVuY3Rpb25JbnZvY2F0aW9uU2NvcGUuXG4gICAqXG4gICAqIEBwYXJhbSBwcm9ncmFtIC0gVGhlIHByb2dyYW0uXG4gICAqIEBwYXJhbSBmdW5jIC0gVGhlIGZ1bmN0aW9uIGZyYWdtZW50LlxuICAgKiBAcGFyYW0gYXJncyAtIFRoZSBhcmd1bWVudHMuXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihwcm9ncmFtLCBmdW5jLCBhcmdzKSB7XG4gICAgc3VwZXIocHJvZ3JhbSwgZmFsc2UpO1xuICAgIHRoaXMuZnVuYyA9IGZ1bmM7XG4gICAgdGhpcy5hcmdzID0gYXJncyB8fCBbXTtcbiAgICB0aGlzLnNldEFyZ3VtZW50cyguLi5hcmdzKTtcbiAgICBzdXBlci5hZGRDYWxsKHRoaXMpO1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjYWxsIGNvbmZpZ3VyYXRpb24uXG4gICAqXG4gICAqIEByZXR1cm5zIFRoZSBjYWxsIGNvbmZpZ3VyYXRpb24uXG4gICAqL1xuICBnZXRDYWxsQ29uZmlnKCkge1xuICAgIHJldHVybiB7XG4gICAgICBmdW5jOiB0aGlzLmZ1bmMsXG4gICAgICBwcm9ncmFtOiB0aGlzLnByb2dyYW0sXG4gICAgICBjYWxsUGFyYW1ldGVyczogdGhpcy5jYWxsUGFyYW1ldGVycyxcbiAgICAgIHR4UGFyYW1ldGVyczogdGhpcy50eFBhcmFtZXRlcnMsXG4gICAgICBmb3J3YXJkOiB0aGlzLmZvcndhcmQsXG4gICAgICBhcmdzOiB0aGlzLmFyZ3MsXG4gICAgICBleHRlcm5hbEFiaXM6IHRoaXMuZXh0ZXJuYWxBYmlzXG4gICAgfTtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgYXJndW1lbnRzIGZvciB0aGUgZnVuY3Rpb24gaW52b2NhdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIGFyZ3MgLSBUaGUgYXJndW1lbnRzLlxuICAgKiBAcmV0dXJucyBUaGUgaW5zdGFuY2Ugb2YgRnVuY3Rpb25JbnZvY2F0aW9uU2NvcGUuXG4gICAqL1xuICBzZXRBcmd1bWVudHMoLi4uYXJncykge1xuICAgIHRoaXMuYXJncyA9IGFyZ3MgfHwgW107XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIGNhbGwgcGFyYW1ldGVycyBmb3IgdGhlIGZ1bmN0aW9uIGludm9jYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSBjYWxsUGFyYW1zIC0gVGhlIGNhbGwgcGFyYW1ldGVycy5cbiAgICogQHJldHVybnMgVGhlIGluc3RhbmNlIG9mIEZ1bmN0aW9uSW52b2NhdGlvblNjb3BlLlxuICAgKiBAdGhyb3dzIElmIHRoZSBmdW5jdGlvbiBpcyBub3QgcGF5YWJsZSBhbmQgZm9yd2FyZCBpcyBzZXQuXG4gICAqL1xuICBjYWxsUGFyYW1zKGNhbGxQYXJhbXMpIHtcbiAgICBpZiAoIXRoaXMuaGFzQ2FsbFBhcmFtc0dhc0xpbWl0ICYmIGNhbGxQYXJhbXM/Lmdhc0xpbWl0ICE9PSB2b2lkIDApIHtcbiAgICAgIHRoaXMuaGFzQ2FsbFBhcmFtc0dhc0xpbWl0ID0gdHJ1ZTtcbiAgICB9XG4gICAgdGhpcy5jYWxsUGFyYW1ldGVycyA9IGNhbGxQYXJhbXM7XG4gICAgaWYgKGNhbGxQYXJhbXM/LmZvcndhcmQpIHtcbiAgICAgIGlmICghdGhpcy5mdW5jLmF0dHJpYnV0ZXMuZmluZCgoYXR0cikgPT4gYXR0ci5uYW1lID09PSBcInBheWFibGVcIikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEZ1ZWxFcnJvcjUoXG4gICAgICAgICAgRXJyb3JDb2RlNS5UUkFOU0FDVElPTl9FUlJPUixcbiAgICAgICAgICBgVGhlIHRhcmdldCBmdW5jdGlvbiAke3RoaXMuZnVuYy5uYW1lfSBjYW5ub3QgYWNjZXB0IGZvcndhcmRlZCBmdW5kcyBhcyBpdCdzIG5vdCBtYXJrZWQgYXMgJ3BheWFibGUnLmBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZm9yd2FyZCA9IGNvaW5RdWFudGl0eWZ5KGNhbGxQYXJhbXMuZm9yd2FyZCk7XG4gICAgfVxuICAgIHRoaXMuc2V0QXJndW1lbnRzKC4uLnRoaXMuYXJncyk7XG4gICAgdGhpcy51cGRhdGVSZXF1aXJlZENvaW5zKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn07XG5cbi8vIHNyYy9mdW5jdGlvbnMvbXVsdGljYWxsLXNjb3BlLnRzXG52YXIgTXVsdGlDYWxsSW52b2NhdGlvblNjb3BlID0gY2xhc3MgZXh0ZW5kcyBCYXNlSW52b2NhdGlvblNjb3BlIHtcbiAgc3RhdGljIHtcbiAgICBfX25hbWUodGhpcywgXCJNdWx0aUNhbGxJbnZvY2F0aW9uU2NvcGVcIik7XG4gIH1cbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYW4gaW5zdGFuY2Ugb2YgTXVsdGlDYWxsSW52b2NhdGlvblNjb3BlLlxuICAgKlxuICAgKiBAcGFyYW0gY29udHJhY3QgLSBUaGUgY29udHJhY3QuXG4gICAqIEBwYXJhbSBmdW5jU2NvcGVzIC0gQW4gYXJyYXkgb2YgZnVuY3Rpb24gaW52b2NhdGlvbiBzY29wZXMuXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihjb250cmFjdCwgZnVuY1Njb3Blcykge1xuICAgIHN1cGVyKGNvbnRyYWN0LCB0cnVlKTtcbiAgICB0aGlzLmFkZENhbGxzKGZ1bmNTY29wZXMpO1xuICB9XG4gIC8qKlxuICAgKiBBZGRzIGEgc2luZ2xlIGZ1bmN0aW9uIGludm9jYXRpb24gc2NvcGUgdG8gdGhlIG11bHRpLWNhbGwgaW52b2NhdGlvbiBzY29wZS5cbiAgICpcbiAgICogQHBhcmFtIGZ1bmNTY29wZSAtIFRoZSBmdW5jdGlvbiBpbnZvY2F0aW9uIHNjb3BlLlxuICAgKiBAcmV0dXJucyBUaGUgaW5zdGFuY2Ugb2YgTXVsdGlDYWxsSW52b2NhdGlvblNjb3BlLlxuICAgKi9cbiAgYWRkQ2FsbChmdW5jU2NvcGUpIHtcbiAgICByZXR1cm4gc3VwZXIuYWRkQ2FsbHMoW2Z1bmNTY29wZV0pO1xuICB9XG4gIC8qKlxuICAgKiBBZGRzIG11bHRpcGxlIGZ1bmN0aW9uIGludm9jYXRpb24gc2NvcGVzIHRvIHRoZSBtdWx0aS1jYWxsIGludm9jYXRpb24gc2NvcGUuXG4gICAqXG4gICAqIEBwYXJhbSBmdW5jU2NvcGVzIC0gQW4gYXJyYXkgb2YgZnVuY3Rpb24gaW52b2NhdGlvbiBzY29wZXMuXG4gICAqIEByZXR1cm5zIFRoZSBpbnN0YW5jZSBvZiBNdWx0aUNhbGxJbnZvY2F0aW9uU2NvcGUuXG4gICAqL1xuICBhZGRDYWxscyhmdW5jU2NvcGVzKSB7XG4gICAgcmV0dXJuIHN1cGVyLmFkZENhbGxzKGZ1bmNTY29wZXMpO1xuICB9XG59O1xuXG4vLyBzcmMvY29udHJhY3QudHNcbmltcG9ydCB7IEludGVyZmFjZSB9IGZyb20gXCJAZnVlbC10cy9hYmktY29kZXJcIjtcbmltcG9ydCB7IEFkZHJlc3MgYXMgQWRkcmVzczIgfSBmcm9tIFwiQGZ1ZWwtdHMvYWRkcmVzc1wiO1xudmFyIENvbnRyYWN0ID0gY2xhc3Mge1xuICBzdGF0aWMge1xuICAgIF9fbmFtZSh0aGlzLCBcIkNvbnRyYWN0XCIpO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgdW5pcXVlIGNvbnRyYWN0IGlkZW50aWZpZXIuXG4gICAqL1xuICBpZDtcbiAgLyoqXG4gICAqIFRoZSBwcm92aWRlciBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgY29udHJhY3QuXG4gICAqL1xuICBwcm92aWRlcjtcbiAgLyoqXG4gICAqIFRoZSBjb250cmFjdCdzIEFCSSBpbnRlcmZhY2UuXG4gICAqL1xuICBpbnRlcmZhY2U7XG4gIC8qKlxuICAgKiBUaGUgYWNjb3VudCBhc3NvY2lhdGVkIHdpdGggdGhlIGNvbnRyYWN0LCBpZiBhdmFpbGFibGUuXG4gICAqL1xuICBhY2NvdW50O1xuICAvKipcbiAgICogQSBjb2xsZWN0aW9uIG9mIGZ1bmN0aW9ucyBhdmFpbGFibGUgb24gdGhlIGNvbnRyYWN0LlxuICAgKi9cbiAgZnVuY3Rpb25zID0ge307XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBDb250cmFjdCBjbGFzcy5cbiAgICpcbiAgICogQHBhcmFtIGlkIC0gVGhlIGNvbnRyYWN0J3MgYWRkcmVzcy5cbiAgICogQHBhcmFtIGFiaSAtIFRoZSBjb250cmFjdCdzIEFCSSAoSlNPTiBBQkkgb3IgSW50ZXJmYWNlIGluc3RhbmNlKS5cbiAgICogQHBhcmFtIGFjY291bnRPclByb3ZpZGVyIC0gVGhlIGFjY291bnQgb3IgcHJvdmlkZXIgZm9yIGludGVyYWN0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3IoaWQsIGFiaSwgYWNjb3VudE9yUHJvdmlkZXIpIHtcbiAgICB0aGlzLmludGVyZmFjZSA9IGFiaSBpbnN0YW5jZW9mIEludGVyZmFjZSA/IGFiaSA6IG5ldyBJbnRlcmZhY2UoYWJpKTtcbiAgICB0aGlzLmlkID0gbmV3IEFkZHJlc3MyKGlkKTtcbiAgICBpZiAoYWNjb3VudE9yUHJvdmlkZXIgJiYgXCJwcm92aWRlclwiIGluIGFjY291bnRPclByb3ZpZGVyKSB7XG4gICAgICB0aGlzLnByb3ZpZGVyID0gYWNjb3VudE9yUHJvdmlkZXIucHJvdmlkZXI7XG4gICAgICB0aGlzLmFjY291bnQgPSBhY2NvdW50T3JQcm92aWRlcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wcm92aWRlciA9IGFjY291bnRPclByb3ZpZGVyO1xuICAgICAgdGhpcy5hY2NvdW50ID0gbnVsbDtcbiAgICB9XG4gICAgT2JqZWN0LmtleXModGhpcy5pbnRlcmZhY2UuZnVuY3Rpb25zKS5mb3JFYWNoKChuYW1lKSA9PiB7XG4gICAgICBjb25zdCBmcmFnbWVudCA9IHRoaXMuaW50ZXJmYWNlLmdldEZ1bmN0aW9uKG5hbWUpO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuZnVuY3Rpb25zLCBmcmFnbWVudC5uYW1lLCB7XG4gICAgICAgIHZhbHVlOiB0aGlzLmJ1aWxkRnVuY3Rpb24oZnJhZ21lbnQpLFxuICAgICAgICB3cml0YWJsZTogZmFsc2VcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBCdWlsZCBhIGZ1bmN0aW9uIGludm9jYXRpb24gc2NvcGUgZm9yIHRoZSBwcm92aWRlZCBmdW5jdGlvbiBmcmFnbWVudC5cbiAgICpcbiAgICogQHBhcmFtIGZ1bmMgLSBUaGUgZnVuY3Rpb24gZnJhZ21lbnQgdG8gYnVpbGQgYSBzY29wZSBmb3IuXG4gICAqIEByZXR1cm5zIEEgZnVuY3Rpb24gdGhhdCBjcmVhdGVzIGEgRnVuY3Rpb25JbnZvY2F0aW9uU2NvcGUuXG4gICAqL1xuICBidWlsZEZ1bmN0aW9uKGZ1bmMpIHtcbiAgICByZXR1cm4gKCgpID0+IHtcbiAgICAgIGNvbnN0IGZ1bmNJbnZvY2F0aW9uU2NvcGVDcmVhdG9yID0gLyogQF9fUFVSRV9fICovIF9fbmFtZSgoLi4uYXJncykgPT4gbmV3IEZ1bmN0aW9uSW52b2NhdGlvblNjb3BlKHRoaXMsIGZ1bmMsIGFyZ3MpLCBcImZ1bmNJbnZvY2F0aW9uU2NvcGVDcmVhdG9yXCIpO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGZ1bmNJbnZvY2F0aW9uU2NvcGVDcmVhdG9yLCBcImlzUmVhZE9ubHlcIiwge1xuICAgICAgICB2YWx1ZTogLyogQF9fUFVSRV9fICovIF9fbmFtZSgoKSA9PiBmdW5jLmlzUmVhZE9ubHkoKSwgXCJ2YWx1ZVwiKSxcbiAgICAgICAgd3JpdGFibGU6IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmdW5jSW52b2NhdGlvblNjb3BlQ3JlYXRvcjtcbiAgICB9KSgpO1xuICB9XG4gIC8qKlxuICAgKiBDcmVhdGUgYSBtdWx0aS1jYWxsIGludm9jYXRpb24gc2NvcGUgZm9yIHRoZSBwcm92aWRlZCBmdW5jdGlvbiBpbnZvY2F0aW9uIHNjb3Blcy5cbiAgICpcbiAgICogQHBhcmFtIGNhbGxzIC0gQW4gYXJyYXkgb2YgRnVuY3Rpb25JbnZvY2F0aW9uU2NvcGVzIHRvIGV4ZWN1dGUgaW4gYSBiYXRjaC5cbiAgICogQHJldHVybnMgQSBNdWx0aUNhbGxJbnZvY2F0aW9uU2NvcGUgaW5zdGFuY2UuXG4gICAqL1xuICBtdWx0aUNhbGwoY2FsbHMpIHtcbiAgICByZXR1cm4gbmV3IE11bHRpQ2FsbEludm9jYXRpb25TY29wZSh0aGlzLCBjYWxscyk7XG4gIH1cbiAgLyoqXG4gICAqIEdldCB0aGUgYmFsYW5jZSBmb3IgYSBnaXZlbiBhc3NldCBJRCBmb3IgdGhpcyBjb250cmFjdC5cbiAgICpcbiAgICogQHBhcmFtIGFzc2V0SWQgLSBUaGUgc3BlY2lmaWVkIGFzc2V0IElELlxuICAgKiBAcmV0dXJucyBUaGUgYmFsYW5jZSBvZiB0aGUgY29udHJhY3QgZm9yIHRoZSBzcGVjaWZpZWQgYXNzZXQuXG4gICAqL1xuICBnZXRCYWxhbmNlKGFzc2V0SWQpIHtcbiAgICByZXR1cm4gdGhpcy5wcm92aWRlci5nZXRDb250cmFjdEJhbGFuY2UodGhpcy5pZCwgYXNzZXRJZCk7XG4gIH1cbn07XG5leHBvcnQge1xuICBBYnN0cmFjdENvbnRyYWN0LFxuICBBYnN0cmFjdFByb2dyYW0sXG4gIENvbnRyYWN0LFxuICBGdW5jdGlvbkludm9jYXRpb25TY29wZSxcbiAgSW5zdHJ1Y3Rpb25TZXQsXG4gIE11bHRpQ2FsbEludm9jYXRpb25TY29wZSxcbiAgU2NyaXB0UmVxdWVzdCxcbiAgYXNzZXJ0LFxuICBidWlsZERyeVJ1blJlc3VsdCxcbiAgYnVpbGRGdW5jdGlvblJlc3VsdCxcbiAgYnVpbGRQcmVDb25maXJtYXRpb25GdW5jdGlvblJlc3VsdCxcbiAgZXh0cmFjdEludm9jYXRpb25SZXN1bHQsXG4gIGdldEFiaXNGcm9tQWxsQ2FsbHMsXG4gIGdldEFsbFJlc3VsdExvZ3MsXG4gIGdldFJlc3VsdExvZ3Ncbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@fuel-ts+program@0.101.1_vitest@3.2.4_@types+debug@4.1.12_@types+node@24.7.2_jiti@2.6.1_6e753f1b81b88d2c391508fb79ab08d1/node_modules/@fuel-ts/program/dist/index.mjs\n");

/***/ })

};
;